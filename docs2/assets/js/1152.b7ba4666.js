"use strict";(self.webpackChunkdockview_docs=self.webpackChunkdockview_docs||[]).push([[1152],{1152:function(e,t,i){i.d(t,{tu:function(){return Xe},$R:function(){return qe},i5:function(){return I},Vm:function(){return tt},TU:function(){return Ke}});class s{constructor(){}}class n extends s{constructor(e,t,i){super(),this.viewId=e,this.groupId=t,this.panelId=i}}class o extends s{constructor(e,t){super(),this.viewId=e,this.paneId=t}}class r{constructor(){}static getInstance(){return r.INSTANCE}hasData(e){return e&&e===this.proto}clearData(e){this.hasData(e)&&(this.proto=void 0,this.data=void 0)}getData(e){if(this.hasData(e))return this.data}setData(e,t){t&&(this.data=e,this.proto=t)}}function a(){const e=r.getInstance();if(e.hasData(n.prototype))return e.getData(n.prototype)[0]}function h(){const e=r.getInstance();if(e.hasData(o.prototype))return e.getData(o.prototype)[0]}var d,l;r.INSTANCE=new r,function(e){e.any=(...e)=>t=>{const i=e.map((e=>e(t)));return{dispose:()=>{i.forEach((e=>{e.dispose()}))}}}}(d||(d={}));class p{constructor(e){this.options=e,this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=e=>{var t;return(null===(t=this.options)||void 0===t?void 0:t.replay)&&void 0!==this._last&&e(this._last),this._listeners.push(e),{dispose:()=>{const t=this._listeners.indexOf(e);t>-1&&this._listeners.splice(t,1)}}}),this._event}fire(e){this._last=e;for(const t of this._listeners)t(e)}dispose(){this._listeners=[],this._disposed=!0}}function m(e,t,i,s){return e.addEventListener(t,i,s),{dispose:()=>{e.removeEventListener(t,i)}}}function u(e,t,i,s){return e.addEventListener(t,i,s),{dispose:()=>{e.removeEventListener(t,i)}}}class c{constructor(){this._onFired=new p,this.onEvent=this._onFired.event}fire(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{this._onFired.fire(),clearTimeout(this.timer)}))}dispose(){this._onFired.dispose()}}!function(e){e.NONE={dispose:()=>{}}}(l||(l={}));class v{constructor(...e){this.disposables=e}static from(...e){return new v(...e)}addDisposables(...e){e.forEach((e=>this.disposables.push(e)))}dispose(){this.disposables.forEach((e=>e.dispose()))}}class g{constructor(){this._disposable=l.NONE}set value(e){this._disposable&&this._disposable.dispose(),this._disposable=e}dispose(){this._disposable&&(this._disposable.dispose(),this._disposable=l.NONE)}}function w(e,t){const i=new ResizeObserver((e=>{const i=e[0];t(i)}));return i.observe(e),{dispose:()=>{i.unobserve(e),i.disconnect()}}}const _=(e,...t)=>{for(const i of t)e.classList.contains(i)&&e.classList.remove(i)},f=(e,...t)=>{for(const i of t)e.classList.contains(i)||e.classList.add(i)},C=(e,t,i)=>{const s=e.classList.contains(t);i&&!s&&e.classList.add(t),!i&&s&&e.classList.remove(t)};function b(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function D(e){return Array.prototype.slice.call(document.getElementsByTagName(e),0)}function y(e){return new S(e)}class S extends v{constructor(e){super(),this._onDidFocus=new p,this.onDidFocus=this._onDidFocus.event,this._onDidBlur=new p,this.onDidBlur=this._onDidBlur.event;let t=b(document.activeElement,e),i=!1;const s=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},n=()=>{t&&(i=!0,window.setTimeout((()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())}),0))};this._refreshStateHandler=()=>{b(document.activeElement,e)!==t&&(t?n():s())},e instanceof HTMLElement?(this.addDisposables(u(e,"focus",s,!0)),this.addDisposables(u(e,"blur",n,!0))):(this.addDisposables(m(e,"focus",s,!0)),this.addDisposables(m(e,"blur",n,!0)))}refreshState(){this._refreshStateHandler()}dispose(){super.dispose(),this._onDidBlur.dispose(),this._onDidFocus.dispose()}}const z=(e,t,i)=>{if(t>i)throw new Error(`${t} > ${i} is an invalid condition`);return Math.min(i,Math.max(e,t))},E=()=>{let e=1;return{next:()=>(e++).toString()}};function x(e){if(0===e.length)throw new Error("Invalid tail call");return[e.slice(0,e.length-1),e[e.length-1]]}function A(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function P(e,t){const i=e.indexOf(t);i>-1&&(e.splice(i,1),e.unshift(t))}function O(e,t){const i=e.indexOf(t);i>-1&&(e.splice(i,1),e.push(t))}const N=(e,t)=>{const i=[];if("number"!=typeof t&&(t=e,e=0),e<=t)for(let s=e;s<t;s++)i.push(s);else for(let s=e;s>t;s--)i.push(s);return i};class V{constructor(e,t,i,s){this.container=e,this.view=t,this.disposable=s,this._cachedVisibleSize=void 0,"number"==typeof i?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}set size(e){this._size=e}get size(){return this._size}get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return void 0===this._cachedVisibleSize}setVisible(e,t){var i;e!==this.visible&&(e?(this.size=z(null!==(i=this._cachedVisibleSize)&&void 0!==i?i:0,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize="number"==typeof t?t:this.size,this.size=0),this.container.classList.toggle("visible",e),this.view.setVisible&&this.view.setVisible(e))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}dispose(){return this.disposable.dispose(),this.view}}var I,L,T,k,G;!function(e){e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL"}(I||(I={})),function(e){e[e.MAXIMUM=0]="MAXIMUM",e[e.MINIMUM=1]="MINIMUM",e[e.DISABLED=2]="DISABLED",e[e.ENABLED=3]="ENABLED"}(L||(L={})),function(e){e.Low="low",e.High="high",e.Normal="normal"}(T||(T={})),function(e){e.Distribute={type:"distribute"},e.Split=function(e){return{type:"split",index:e}},e.Invisible=function(e){return{type:"invisible",cachedVisibleSize:e}}}(k||(k={}));class R{constructor(e,t){this.container=e,this.views=[],this.sashes=[],this._size=0,this._orthogonalSize=0,this.contentSize=0,this._proportions=void 0,this._onDidSashEnd=new p,this.onDidSashEnd=this._onDidSashEnd.event,this._onDidAddView=new p,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new p,this.onDidRemoveView=this._onDidRemoveView.event,this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.resize=(e,t,i=this.views.map((e=>e.size)),s,n,o=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,a,h)=>{if(e<0||e>this.views.length)return 0;const d=N(e,-1),l=N(e+1,this.views.length);if(n)for(const z of n)P(d,z),P(l,z);if(s)for(const z of s)O(d,z),O(l,z);const p=d.map((e=>this.views[e])),m=d.map((e=>i[e])),u=l.map((e=>this.views[e])),c=l.map((e=>i[e])),v=d.reduce(((e,t)=>e+this.views[t].minimumSize-i[t]),0),g=d.reduce(((e,t)=>e+this.views[t].maximumSize-i[t]),0),w=0===l.length?Number.POSITIVE_INFINITY:l.reduce(((e,t)=>e+i[t]-this.views[t].minimumSize),0),_=0===l.length?Number.NEGATIVE_INFINITY:l.reduce(((e,t)=>e+i[t]-this.views[t].maximumSize),0),f=Math.max(v,_),C=Math.min(w,g);let b=!1;if(a){const e=this.views[a.index],i=t>=a.limitDelta;b=i!==e.visible,e.setVisible(i,a.size)}if(!b&&h){const e=this.views[h.index],i=t<h.limitDelta;b=i!==e.visible,e.setVisible(i,h.size)}if(b)return this.resize(e,t,i,s,n,o,r);let D=0,y=z(t,f,C);for(let E=0;E<p.length;E++){const e=p[E],t=z(m[E]+y,e.minimumSize,e.maximumSize),i=t-m[E];D+=i,y-=i,e.size=t}let S=D;for(let E=0;E<u.length;E++){const e=u[E],t=z(c[E]-S,e.minimumSize,e.maximumSize);S+=t-c[E],e.size=t}return t},this._orientation=t.orientation,this.element=this.createContainer(),this.proportionalLayout=void 0===t.proportionalLayout||!!t.proportionalLayout,this.viewContainer=this.createViewContainer(),this.sashContainer=this.createSashContainer(),this.element.appendChild(this.sashContainer),this.element.appendChild(this.viewContainer),this.container.appendChild(this.element),this.style(t.styles),t.descriptor&&(this._size=t.descriptor.size,t.descriptor.views.forEach(((e,t)=>{const i=void 0===e.visible||e.visible?e.size:{type:"invisible",cachedVisibleSize:e.size},s=e.view;this.addView(s,i,t,!0)})),this.contentSize=this.views.reduce(((e,t)=>e+t.size),0),this.saveProportions())}get size(){return this._size}set size(e){this._size=e}get orthogonalSize(){return this._orthogonalSize}set orthogonalSize(e){this._orthogonalSize=e}get length(){return this.views.length}get proportions(){return this._proportions?[...this._proportions]:void 0}get orientation(){return this._orientation}set orientation(e){this._orientation=e;const t=this.size;this.size=this.orthogonalSize,this.orthogonalSize=t,_(this.element,"horizontal","vertical"),this.element.classList.add(this.orientation==I.HORIZONTAL?"horizontal":"vertical")}get minimumSize(){return this.views.reduce(((e,t)=>e+t.minimumSize),0)}get maximumSize(){return 0===this.length?Number.POSITIVE_INFINITY:this.views.reduce(((e,t)=>e+t.maximumSize),0)}get startSnappingEnabled(){return this._startSnappingEnabled}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}get endSnappingEnabled(){return this._endSnappingEnabled}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}style(e){"transparent"===(null==e?void 0:e.separatorBorder)?(_(this.element,"separator-border"),this.element.style.removeProperty("--dv-separator-border")):(f(this.element,"separator-border"),(null==e?void 0:e.separatorBorder)&&this.element.style.setProperty("--dv-separator-border",e.separatorBorder))}isViewVisible(e){if(e<0||e>=this.views.length)throw new Error("Index out of bounds");return this.views[e].visible}setViewVisible(e,t){if(e<0||e>=this.views.length)throw new Error("Index out of bounds");C(this.container,"visible",t);const i=this.views[e];C(this.container,"visible",t),i.setVisible(t,i.size),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewSize(e){return e<0||e>=this.views.length?-1:this.views[e].size}resizeView(e,t){if(e<0||e>=this.views.length)return;const i=N(this.views.length).filter((t=>t!==e)),s=[...i.filter((e=>this.views[e].priority===T.Low)),e],n=i.filter((e=>this.views[e].priority===T.High)),o=this.views[e];t=Math.round(t),t=z(t,o.minimumSize,Math.min(o.maximumSize,this._size)),o.size=t,this.relayout(s,n)}getViews(){return this.views.map((e=>e.view))}onDidChange(e,t){const i=this.views.indexOf(e);i<0||i>=this.views.length||(t="number"==typeof t?t:e.size,t=z(t,e.minimumSize,e.maximumSize),e.size=t,this.relayout([i]))}addView(e,t={type:"distribute"},i=this.views.length,s){const n=document.createElement("div");let o;n.className="view",n.appendChild(e.element),o="number"==typeof t?t:"split"===t.type?this.getViewSize(t.index)/2:"invisible"===t.type?{cachedVisibleSize:t.cachedVisibleSize}:e.minimumSize;const r=e.onDidChange((e=>this.onDidChange(a,e))),a=new V(n,e,o,{dispose:()=>{null==r||r.dispose(),this.viewContainer.removeChild(n)}});if(i===this.views.length?this.viewContainer.appendChild(n):this.viewContainer.insertBefore(n,this.viewContainer.children.item(i)),this.views.splice(i,0,a),this.views.length>1){const e=document.createElement("div");e.className="sash";const t=t=>{for(const e of this.views)e.enabled=!1;const i=[...D("iframe"),...D("webview")];for(const e of i)e.style.pointerEvents="none";const s=this._orientation===I.HORIZONTAL?t.clientX:t.clientY,n=function(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return i;return-1}(this.sashes,(t=>t.container===e)),o=this.views.map((e=>e.size));let r,a;const h=N(n,-1),d=N(n+1,this.views.length),l=h.reduce(((e,t)=>e+(this.views[t].minimumSize-o[t])),0),p=h.reduce(((e,t)=>e+(this.views[t].viewMaximumSize-o[t])),0),m=0===d.length?Number.POSITIVE_INFINITY:d.reduce(((e,t)=>e+(o[t]-this.views[t].minimumSize)),0),u=0===d.length?Number.NEGATIVE_INFINITY:d.reduce(((e,t)=>e+(o[t]-this.views[t].viewMaximumSize)),0),c=Math.max(l,u),v=Math.min(m,p),g=this.findFirstSnapIndex(h),w=this.findFirstSnapIndex(d);if("number"==typeof g){const e=this.views[g],t=Math.floor(e.viewMinimumSize/2);r={index:g,limitDelta:e.visible?c-t:c+t,size:e.size}}if("number"==typeof w){const e=this.views[w],t=Math.floor(e.viewMinimumSize/2);a={index:w,limitDelta:e.visible?v+t:v-t,size:e.size}}const _=e=>{const t=(this._orientation===I.HORIZONTAL?e.clientX:e.clientY)-s;this.resize(n,t,o,void 0,void 0,c,v,r,a),this.distributeEmptySpace(),this.layoutViews()},f=()=>{for(const e of this.views)e.enabled=!0;for(const e of i)e.style.pointerEvents="auto";this.saveProportions(),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",f),document.removeEventListener("mouseend",f),this._onDidSashEnd.fire(void 0)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",f),document.addEventListener("mouseend",f)};e.addEventListener("mousedown",t);const i={container:e,disposable:()=>{e.removeEventListener("mousedown",t),this.sashContainer.removeChild(e)}};this.sashContainer.appendChild(e),this.sashes.push(i)}s||this.relayout([i]),s||"number"==typeof t||"distribute"!==t.type||this.distributeViewSizes(),this._onDidAddView.fire(e)}distributeViewSizes(){const e=[];let t=0;for(const r of this.views)r.maximumSize-r.minimumSize>0&&(e.push(r),t+=r.size);const i=Math.floor(t/e.length);for(const r of e)r.size=z(i,r.minimumSize,r.maximumSize);const s=N(this.views.length),n=s.filter((e=>this.views[e].priority===T.Low)),o=s.filter((e=>this.views[e].priority===T.High));this.relayout(n,o)}removeView(e,t,i=!1){const s=this.views.splice(e,1)[0];if(s.dispose(),this.views.length>=1){const t=Math.max(e-1,0);this.sashes.splice(t,1)[0].disposable()}return i||this.relayout(),t&&"distribute"===t.type&&this.distributeViewSizes(),this._onDidRemoveView.fire(s.view),s.view}getViewCachedVisibleSize(e){if(e<0||e>=this.views.length)throw new Error("Index out of bounds");return this.views[e].cachedVisibleSize}moveView(e,t){const i=this.getViewCachedVisibleSize(e),s=void 0===i?this.getViewSize(e):k.Invisible(i),n=this.removeView(e,void 0,!0);this.addView(n,s,t)}layout(e,t){const i=Math.max(this.size,this.contentSize);if(this.size=e,this.orthogonalSize=t,this.proportions)for(let s=0;s<this.views.length;s++){const t=this.views[s];t.size=z(Math.round(this.proportions[s]*e),t.minimumSize,t.maximumSize)}else{const t=N(this.views.length),s=t.filter((e=>this.views[e].priority===T.Low)),n=t.filter((e=>this.views[e].priority===T.High));this.resize(this.views.length-1,e-i,void 0,s,n)}this.distributeEmptySpace(),this.layoutViews()}relayout(e,t){const i=this.views.reduce(((e,t)=>e+t.size),0);this.resize(this.views.length-1,this._size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}distributeEmptySpace(e){const t=this.views.reduce(((e,t)=>e+t.size),0);let i=this.size-t;const s=N(this.views.length-1,-1),n=s.filter((e=>this.views[e].priority===T.Low)),o=s.filter((e=>this.views[e].priority===T.High));for(const r of o)P(s,r);for(const r of n)O(s,r);"number"==typeof e&&O(s,e);for(let r=0;0!==i&&r<s.length;r++){const e=this.views[s[r]],t=z(e.size+i,e.minimumSize,e.maximumSize);i-=t-e.size,e.size=t}}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this._proportions=this.views.map((e=>e.size/this.contentSize)))}layoutViews(){this.contentSize=this.views.reduce(((e,t)=>e+t.size),0);let e=0;const t=[];this.updateSashEnablement();for(let i=0;i<this.views.length-1;i++){e+=this.views[i].size,t.push(e);const s=Math.min(Math.max(0,e-2),this.size-4);this._orientation===I.HORIZONTAL&&(this.sashes[i].container.style.left=`${s}px`,this.sashes[i].container.style.top="0px"),this._orientation===I.VERTICAL&&(this.sashes[i].container.style.left="0px",this.sashes[i].container.style.top=`${s}px`)}this.views.forEach(((e,i)=>{this._orientation===I.HORIZONTAL&&(e.container.style.width=`${e.size}px`,e.container.style.left=0==i?"0px":`${t[i-1]}px`,e.container.style.top="",e.container.style.height=""),this._orientation===I.VERTICAL&&(e.container.style.height=`${e.size}px`,e.container.style.top=0==i?"0px":`${t[i-1]}px`,e.container.style.width="",e.container.style.left=""),e.view.layout(e.size,this._orthogonalSize)}))}findFirstSnapIndex(e){for(const t of e){const e=this.views[t];if(e.visible&&e.snap)return t}for(const t of e){const e=this.views[t];if(e.visible&&e.maximumSize-e.minimumSize>0)return;if(!e.visible&&e.snap)return t}}updateSashEnablement(){let e=!1;const t=this.views.map((t=>e=t.size-t.minimumSize>0||e));e=!1;const i=this.views.map((t=>e=t.maximumSize-t.size>0||e)),s=[...this.views].reverse();e=!1;const n=s.map((t=>e=t.size-t.minimumSize>0||e)).reverse();e=!1;const o=s.map((t=>e=t.maximumSize-t.size>0||e)).reverse();let r=0;for(let a=0;a<this.sashes.length;a++){const e=this.sashes[a];r+=this.views[a].size;const s=!(t[a]&&o[a+1]),h=!(i[a]&&n[a+1]);if(s&&h){const i=N(a,-1),s=N(a+1,this.views.length),o=this.findFirstSnapIndex(i),h=this.findFirstSnapIndex(s),d="number"==typeof o&&!this.views[o].visible,l="number"==typeof h&&!this.views[h].visible;d&&n[a]&&(r>0||this.startSnappingEnabled)?this.updateSash(e,L.MINIMUM):l&&t[a]&&(r<this.contentSize||this.endSnappingEnabled)?this.updateSash(e,L.MAXIMUM):this.updateSash(e,L.DISABLED)}else s&&!h?this.updateSash(e,L.MINIMUM):!s&&h?this.updateSash(e,L.MAXIMUM):this.updateSash(e,L.ENABLED)}}updateSash(e,t){C(e.container,"disabled",t===L.DISABLED),C(e.container,"enabled",t===L.ENABLED),C(e.container,"maximum",t===L.MAXIMUM),C(e.container,"minimum",t===L.MINIMUM)}createViewContainer(){const e=document.createElement("div");return e.className="view-container",e}createSashContainer(){const e=document.createElement("div");return e.className="sash-container",e}createContainer(){const e=document.createElement("div"),t=this._orientation===I.HORIZONTAL?"horizontal":"vertical";return e.className=`split-view-container ${t}`,e}dispose(){this._onDidSashEnd.dispose(),this._onDidAddView.dispose(),this._onDidRemoveView.dispose();for(let e=0;e<this.element.children.length;e++)if(this.element.children.item(e)===this.element){this.element.removeChild(this.element);break}this.element.remove()}}class H extends v{constructor(e,t){var i;super(),this.paneItems=[],this.skipAnimation=!1,this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this._orientation=null!==(i=t.orientation)&&void 0!==i?i:I.VERTICAL,this.element=document.createElement("div"),this.element.className="pane-container",e.appendChild(this.element),this.splitview=new R(this.element,{orientation:this._orientation,proportionalLayout:!1,descriptor:t.descriptor}),this.getPanes().forEach((e=>{const t=new v(e.onDidChangeExpansionState((()=>{this.setupAnimation(),this._onDidChange.fire(void 0)}))),i={pane:e,disposable:{dispose:()=>{t.dispose()}}};this.paneItems.push(i),e.orthogonalSize=this.splitview.orthogonalSize})),this.addDisposables(this._onDidChange,this.splitview.onDidSashEnd((()=>{this._onDidChange.fire(void 0)})),this.splitview.onDidAddView((()=>{this._onDidChange.fire()})),this.splitview.onDidRemoveView((()=>{this._onDidChange.fire()})))}get onDidAddView(){return this.splitview.onDidAddView}get onDidRemoveView(){return this.splitview.onDidRemoveView}get minimumSize(){return this.splitview.minimumSize}get maximumSize(){return this.splitview.maximumSize}get orientation(){return this.splitview.orientation}get size(){return this.splitview.size}get orthogonalSize(){return this.splitview.orthogonalSize}addPane(e,t,i=this.splitview.length,s=!1){const n=e.onDidChangeExpansionState((()=>{this.setupAnimation(),this._onDidChange.fire(void 0)})),o={pane:e,disposable:{dispose:()=>{n.dispose()}}};this.paneItems.splice(i,0,o),e.orthogonalSize=this.splitview.orthogonalSize,this.splitview.addView(e,t,i,s)}getViewSize(e){return this.splitview.getViewSize(e)}getPanes(){return this.splitview.getViews()}removePane(e,t={skipDispose:!1}){const i=this.paneItems.splice(e,1)[0];return this.splitview.removeView(e),t.skipDispose||(i.disposable.dispose(),i.pane.dispose()),i}moveView(e,t){if(e===t)return;const i=this.removePane(e,{skipDispose:!0});this.skipAnimation=!0;try{this.addPane(i.pane,i.pane.size,t,!1)}finally{this.skipAnimation=!1}}layout(e,t){this.splitview.layout(e,t)}setupAnimation(){this.skipAnimation||(this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=void 0),f(this.element,"animated"),this.animationTimer=setTimeout((()=>{this.animationTimer=void 0,_(this.element,"animated")}),200))}dispose(){super.dispose(),this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=void 0),this.paneItems.forEach((e=>{e.disposable.dispose(),e.pane.dispose()})),this.paneItems=[],this.splitview.dispose(),this.element.remove()}}class M extends v{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.registerListeners()}registerListeners(){this.addDisposables(u(this.element,"dragenter",(e=>{this.counter++,this.callbacks.onDragEnter(e)}))),this.addDisposables(u(this.element,"dragover",(e=>{e.preventDefault(),this.callbacks.onDragOver&&this.callbacks.onDragOver(e)}))),this.addDisposables(u(this.element,"dragleave",(e=>{this.counter--,0===this.counter&&this.callbacks.onDragLeave(e)}))),this.addDisposables(u(this.element,"dragend",(e=>{this.counter=0,this.callbacks.onDragEnd(e)}))),this.addDisposables(u(this.element,"drop",(e=>{this.counter=0,this.callbacks.onDrop(e)})))}}!function(e){e.Top="Top",e.Left="Left",e.Bottom="Bottom",e.Right="Right",e.Center="Center"}(G||(G={}));class F extends v{constructor(e,t){super(),this.element=e,this.options=t,this._onDrop=new p,this.onDrop=this._onDrop.event,this.addDisposables(this._onDrop,new M(this.element,{onDragEnter:()=>{},onDragOver:e=>{const t=this.element.clientWidth,i=this.element.clientHeight;if(0===t||0===i)return;const s=100*e.offsetX/t,n=100*e.offsetY/i,o=this.calculateQuadrant(this.options.validOverlays,s,n);if("boolean"==typeof this.options.canDisplayOverlay){if(!this.options.canDisplayOverlay)return}else if(!this.options.canDisplayOverlay(e,o))return;if(this.target||(this.target=document.createElement("div"),this.target.className="drop-target-dropzone",this.overlay=document.createElement("div"),this.overlay.className="drop-target-selection",this._state=G.Center,this.target.appendChild(this.overlay),this.element.classList.add("drop-target"),this.element.append(this.target)),"none"===this.options.validOverlays)return;if(!this.target||!this.overlay)return;const r=t<100,a=i<100;this.toggleClasses(o,r,a),this.setState(o)},onDragLeave:()=>{this.removeDropTarget()},onDragEnd:()=>{this.removeDropTarget()},onDrop:e=>{e.preventDefault(),e.stopPropagation();const t=this._state;this.removeDropTarget(),t&&this._onDrop.fire({position:t,nativeEvent:e})}}))}get state(){return this._state}set validOverlays(e){this.options.validOverlays=e}set canDisplayOverlay(e){this.options.canDisplayOverlay=e}dispose(){this.removeDropTarget()}toggleClasses(e,t,i){if(!this.overlay)return;const s="left"===e,n="right"===e,o="top"===e,r="bottom"===e;C(this.overlay,"right",!t&&n),C(this.overlay,"left",!t&&s),C(this.overlay,"top",!i&&o),C(this.overlay,"bottom",!i&&r),C(this.overlay,"small-right",t&&n),C(this.overlay,"small-left",t&&s),C(this.overlay,"small-top",i&&o),C(this.overlay,"small-bottom",i&&r)}setState(e){switch(e){case"top":this._state=G.Top;break;case"left":this._state=G.Left;break;case"bottom":this._state=G.Bottom;break;case"right":this._state=G.Right;break;default:this._state=G.Center}}calculateQuadrant(e,t,i){switch(e){case"all":if(t<20)return"left";if(t>80)return"right";if(i<20)return"top";if(i>80)return"bottom";break;case"vertical":return i<50?"top":"bottom";case"horizontal":return t<50?"left":"right"}return null}removeDropTarget(){this.target&&(this._state=void 0,this.element.removeChild(this.target),this.target=void 0,this.element.classList.remove("drop-target"))}}class W{constructor(e,t,i,s=0){this.view=e,this.orientation=t,this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this._orthogonalSize=i,this._size=s,this._disposable=this.view.onDidChange((e=>{e?this._onDidChange.fire(this.orientation===I.VERTICAL?e.width:e.height):this._onDidChange.fire(void 0)}))}get minimumWidth(){return this.view.minimumWidth}get maximumWidth(){return this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get priority(){return this.view.priority}get snap(){return this.view.snap}get minimumSize(){return this.orientation===I.HORIZONTAL?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===I.HORIZONTAL?this.maximumHeight:this.maximumWidth}get minimumOrthogonalSize(){return this.orientation===I.HORIZONTAL?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===I.HORIZONTAL?this.maximumWidth:this.maximumHeight}get orthogonalSize(){return this._orthogonalSize}get size(){return this._size}get element(){return this.view.element}get width(){return this.orientation===I.HORIZONTAL?this.orthogonalSize:this.size}get height(){return this.orientation===I.HORIZONTAL?this.size:this.orthogonalSize}setVisible(e){this.view.setVisible&&(this.view.setVisible(e),this._onDidChange.fire(void 0))}layout(e,t){this._size=e,this._orthogonalSize=t,this.view.layout(this.width,this.height)}dispose(){this._onDidChange.dispose(),this._disposable.dispose()}}class J extends v{constructor(e,t,i,s,n,o){if(super(),this.orientation=e,this.proportionalLayout=t,this.styles=i,this.children=[],this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this._childrenDisposable=l.NONE,this._orthogonalSize=n,this._size=s,this.element=document.createElement("div"),this.element.className="branch-node",o){const e={views:o.map((e=>({view:e.node,size:e.node.size,visible:!(e.node instanceof W&&void 0!==e.visible)||e.visible}))),size:this.size};this.children=o.map((e=>e.node)),this.splitview=new R(this.element,{orientation:this.orientation,descriptor:e,proportionalLayout:t})}else this.splitview=new R(this.element,{orientation:this.orientation,proportionalLayout:t,styles:i}),this.splitview.layout(this.size,this.orthogonalSize);this.addDisposables(this._onDidChange,this.splitview.onDidSashEnd((()=>{this._onDidChange.fire(void 0)}))),this.setupChildrenEvents()}get width(){return this.orientation===I.HORIZONTAL?this.size:this.orthogonalSize}get height(){return this.orientation===I.HORIZONTAL?this.orthogonalSize:this.size}get minimumSize(){return 0===this.children.length?0:Math.max(...this.children.map((e=>e.minimumOrthogonalSize)))}get maximumSize(){return Math.min(...this.children.map((e=>e.maximumOrthogonalSize)))}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get orthogonalSize(){return this._orthogonalSize}get size(){return this._size}get minimumWidth(){return this.orientation===I.HORIZONTAL?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===I.HORIZONTAL?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===I.HORIZONTAL?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===I.HORIZONTAL?this.maximumSize:this.maximumOrthogonalSize}get priority(){if(0===this.children.length)return T.Normal;const e=this.children.map((e=>void 0===e.priority?T.Normal:e.priority));return e.some((e=>e===T.High))?T.High:e.some((e=>e===T.Low))?T.Low:T.Normal}setVisible(e){for(const t of this.children)t.setVisible(e)}isChildVisible(e){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.isViewVisible(e)}setChildVisible(e,t){if(e<0||e>=this.children.length)throw new Error("Invalid index");this.splitview.isViewVisible(e)!==t&&this.splitview.setViewVisible(e,t)}moveChild(e,t){if(e===t)return;if(e<0||e>=this.children.length)throw new Error("Invalid from index");e<t&&t--,this.splitview.moveView(e,t);const i=this._removeChild(e);this._addChild(i,t)}getChildSize(e){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.getViewSize(e)}resizeChild(e,t){if(e<0||e>=this.children.length)throw new Error("Invalid index");this.splitview.resizeView(e,t)}layout(e,t){this._size=t,this._orthogonalSize=e,this.splitview.layout(this.size,this.orthogonalSize)}addChild(e,t,i,s){if(i<0||i>this.children.length)throw new Error("Invalid index");this.splitview.addView(e,t,i,s),this._addChild(e,i)}getChildCachedVisibleSize(e){if(e<0||e>=this.children.length)throw new Error("Invalid index");return this.splitview.getViewCachedVisibleSize(e)}removeChild(e,t){if(e<0||e>=this.children.length)throw new Error("Invalid index");this.splitview.removeView(e,t),this._removeChild(e)}_addChild(e,t){this.children.splice(t,0,e),this.setupChildrenEvents()}_removeChild(e){const[t]=this.children.splice(e,1);return this.setupChildrenEvents(),t}setupChildrenEvents(){this._childrenDisposable.dispose(),this._childrenDisposable=d.any(...this.children.map((e=>e.onDidChange)))((()=>{this._onDidChange.fire(void 0)}))}dispose(){super.dispose(),this._childrenDisposable.dispose(),this.children.forEach((e=>e.dispose())),this.splitview.dispose()}}function B(e,t){if(e instanceof W)return e;if(e instanceof J)return B(e.children[t?e.children.length-1:0],t);throw new Error("invalid node")}function j(e,t,i){if(e instanceof J){const s=new J(U(e.orientation),e.proportionalLayout,e.styles,t,i);let n=0;for(let o=e.children.length-1;o>=0;o--){const r=e.children[o],a=r instanceof J?r.orthogonalSize:r.size;let h=0===e.size?0:Math.round(t*a/e.size);n+=h,0===o&&(h+=t-n),s.addChild(j(r,i,h),h,0,!0)}return s}return new W(e.view,U(e.orientation),i)}function $(e){const t=e.parentElement;if(!t)throw new Error("Invalid grid element");if(/\bgrid-view\b/.test(t.className))return[];const i=function(e){const t=e.parentElement;if(!t)throw new Error("Invalid grid element");let i=t.firstElementChild,s=0;for(;i!==e&&i!==t.lastElementChild&&i;)i=i.nextElementSibling,s++;return s}(t);return[...$(t.parentElement.parentElement.parentElement),i]}function Z(e,t,i){const s=function(e,t){return t.length%2==0?U(e):e}(e,t),n=function(e){return e===G.Top||e===G.Bottom?I.VERTICAL:I.HORIZONTAL}(i);if(s===n){const[e,s]=x(t);let n=s;return i!==G.Right&&i!==G.Bottom||(n+=1),[...e,n]}{const e=i===G.Right||i===G.Bottom?1:0;return[...t,e]}}const U=e=>e===I.HORIZONTAL?I.VERTICAL:I.HORIZONTAL;const X=(e,t)=>{const i=t===I.VERTICAL?e.box.width:e.box.height;return function(e){return!!e.children}(e)?{type:"branch",data:e.children.map((e=>X(e,U(t)))),size:i}:"number"==typeof e.cachedVisibleSize?{type:"leaf",data:e.view.toJSON(),size:e.cachedVisibleSize,visible:!1}:{type:"leaf",data:e.view.toJSON(),size:i}};class Y{constructor(e,t,i){this.proportionalLayout=e,this.styles=t,this.disposable=new g,this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this.element=document.createElement("div"),this.element.className="grid-view",this.root=new J(i,e,t,0,0)}serialize(){return{root:X(this.getView(),this.orientation),width:this.width,height:this.height,orientation:this.orientation}}dispose(){this.disposable.dispose(),this._onDidChange.dispose(),this.root.dispose(),this.element.remove()}clear(){const e=this.root.orientation;this.root=new J(e,this.proportionalLayout,this.styles,this.root.size,this.root.orthogonalSize)}deserialize(e,t){const i=e.orientation,s=i===I.VERTICAL?e.height:e.width;this._deserialize(e.root,i,t,s)}_deserialize(e,t,i,s){this.root=this._deserializeNode(e,t,i,s,!0)}_deserializeNode(e,t,i,s,n=!1){let o;if("branch"===e.type){const r=e.data.map((s=>({node:this._deserializeNode(s,U(t),i,e.size),visible:s.visible})));o=new J(t,this.proportionalLayout,this.styles,n?s:e.size,n?e.size:s,r)}else o=new W(i.fromJSON(e),t,s,e.size);return o}get orientation(){return this.root.orientation}set orientation(e){if(this.root.orientation===e)return;const{size:t,orthogonalSize:i}=this.root;this.root=j(this.root,i,t),this.root.layout(t,i)}get root(){return this._root}set root(e){const t=this._root;t&&(t.dispose(),this.element.removeChild(t.element)),this._root=e,this.element.appendChild(this._root.element),this.disposable.value=this._root.onDidChange((e=>{this._onDidChange.fire(e)}))}next(e){return this.progmaticSelect(e)}previous(e){return this.progmaticSelect(e,!0)}getView(e){const t=e?this.getNode(e)[1]:this.root;return this._getViews(t,this.orientation)}_getViews(e,t,i){const s={height:e.height,width:e.width};if(e instanceof W)return{box:s,view:e.view,cachedVisibleSize:i};const n=[];for(let o=0;o<e.children.length;o++){const i=e.children[o],s=e.getChildCachedVisibleSize(o);n.push(this._getViews(i,U(t),s))}return{box:s,children:n}}progmaticSelect(e,t=!1){const[i,s]=this.getNode(e);if(!(s instanceof W))throw new Error("invalid location");for(let n=i.length-1;n>-1;n--){const s=i[n],o=e[n]||0;if(t?o-1>-1:o+1<s.children.length)return B(s.children[t?o-1:o+1],t)}return B(this.root,t)}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}isViewVisible(e){const[t,i]=x(e),[,s]=this.getNode(t);if(!(s instanceof J))throw new Error("Invalid from location");return s.isChildVisible(i)}setViewVisible(e,t){const[i,s]=x(e),[,n]=this.getNode(i);if(!(n instanceof J))throw new Error("Invalid from location");n.setChildVisible(s,t)}moveView(e,t,i){const[,s]=this.getNode(e);if(!(s instanceof J))throw new Error("Invalid location");s.moveChild(t,i)}addView(e,t,i){const[s,n]=x(i),[o,r]=this.getNode(s);if(r instanceof J){const i=new W(e,U(r.orientation),r.orthogonalSize);r.addChild(i,t,n)}else{const[i,...a]=[...o].reverse(),[h,...d]=[...s].reverse();let l=0;const p=i.getChildCachedVisibleSize(h);"number"==typeof p&&(l=k.Invisible(p)),i.removeChild(h);const m=new J(r.orientation,this.proportionalLayout,this.styles,r.size,r.orthogonalSize);i.addChild(m,r.size,h);const u=new W(r.view,i.orientation,r.size);m.addChild(u,l,0),"number"!=typeof t&&"split"===t.type&&(t={type:"split",index:0});const c=new W(e,i.orientation,r.size);m.addChild(c,t,n)}}remove(e,t){const i=$(e.element);return this.removeView(i,t)}removeView(e,t){const[i,s]=x(e),[n,o]=this.getNode(i);if(!(o instanceof J))throw new Error("Invalid location");const r=o.children[s];if(!(r instanceof W))throw new Error("Invalid location");if(o.removeChild(s,t),0===o.children.length)return r.view;if(o.children.length>1)return r.view;const a=o.children[0];if(0===n.length)return a instanceof W||(o.removeChild(0,t),this.root=a),r.view;const[h,...d]=[...n].reverse(),[l,...p]=[...i].reverse(),m=o.isChildVisible(0);o.removeChild(0,t);const u=h.children.map(((e,t)=>h.getChildSize(t)));if(h.removeChild(l,t),a instanceof J){u.splice(l,1,...a.children.map((e=>e.size)));for(let e=0;e<a.children.length;e++){const t=a.children[e];h.addChild(t,t.size,l+e)}}else{const e=new W(a.view,U(a.orientation),a.size),t=m?a.orthogonalSize:k.Invisible(a.orthogonalSize);h.addChild(e,t,l)}for(let c=0;c<u.length;c++)h.resizeChild(c,u[c]);return r.view}layout(e,t){const[i,s]=this.root.orientation===I.HORIZONTAL?[t,e]:[e,t];this.root.layout(i,s)}getNode(e,t=this.root,i=[]){if(0===e.length)return[i,t];if(!(t instanceof J))throw new Error("Invalid location");const[s,...n]=e;if(s<0||s>=t.children.length)throw new Error("Invalid location");const o=t.children[s];return i.push(t),this.getNode(n,o,i)}}class K{constructor(e){this.component=e}get minimumSize(){return this.component.minimumSize}get maximumSize(){return this.component.maximumSize}get height(){return this.component.height}get width(){return this.component.width}get length(){return this.component.length}get orientation(){return this.component.orientation}get panels(){return this.component.panels}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidAddView(){return this.component.onDidAddView}get onDidRemoveView(){return this.component.onDidRemoveView}updateOptions(e){this.component.updateOptions(e)}removePanel(e,t){this.component.removePanel(e,t)}focus(){this.component.focus()}getPanel(e){return this.component.getPanel(e)}layout(e,t){return this.component.layout(e,t)}addPanel(e){return this.component.addPanel(e)}movePanel(e,t){this.component.movePanel(e,t)}fromJSON(e){this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}}class Q{constructor(e){this.component=e}get minimumSize(){return this.component.minimumSize}get maximumSize(){return this.component.maximumSize}get height(){return this.component.height}get width(){return this.component.width}get panels(){return this.component.panels}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get onDidAddView(){return this.component.onDidAddView}get onDidRemoveView(){return this.component.onDidRemoveView}get onDidDrop(){const e=new p,t=this.component.onDidDrop((t=>{e.fire(Object.assign(Object.assign({},t),{api:this}))}));return e.dispose=()=>{t.dispose(),e.dispose()},e.event}removePanel(e){this.component.removePanel(e)}getPanel(e){return this.component.getPanel(e)}movePanel(e,t){this.component.movePanel(e,t)}focus(){this.component.focus()}layout(e,t){this.component.layout(e,t)}addPanel(e){return this.component.addPanel(e)}fromJSON(e){this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}}class q{constructor(e){this.component=e}get minimumHeight(){return this.component.minimumHeight}get maximumHeight(){return this.component.maximumHeight}get minimumWidth(){return this.component.minimumWidth}get maximumWidth(){return this.component.maximumWidth}get width(){return this.component.width}get height(){return this.component.height}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidAddPanel(){return this.component.onDidAddGroup}get onDidRemovePanel(){return this.component.onDidRemoveGroup}get onDidActivePanelChange(){return this.component.onDidActiveGroupChange}get onDidLayoutFromJSON(){return this.component.onDidLayoutFromJSON}get panels(){return this.component.groups}get orientation(){return this.component.orientation}set orientation(e){this.component.updateOptions({orientation:e})}focus(){this.component.focus()}layout(e,t,i=!1){this.component.layout(e,t,i)}addPanel(e){return this.component.addPanel(e)}removePanel(e,t){this.component.removePanel(e,t)}movePanel(e,t){this.component.movePanel(e,t)}getPanel(e){return this.component.getPanel(e)}fromJSON(e){return this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}}class ee{constructor(e){this.component=e}get width(){return this.component.width}get height(){return this.component.height}get minimumHeight(){return this.component.minimumHeight}get maximumHeight(){return this.component.maximumHeight}get minimumWidth(){return this.component.minimumWidth}get maximumWidth(){return this.component.maximumWidth}get size(){return this.component.size}get totalPanels(){return this.component.totalPanels}get onDidActiveGroupChange(){return this.component.onDidActiveGroupChange}get onDidAddGroup(){return this.component.onDidAddGroup}get onDidRemoveGroup(){return this.component.onDidRemoveGroup}get onDidActivePanelChange(){return this.component.onDidActivePanelChange}get onDidAddPanel(){return this.component.onDidAddPanel}get onDidRemovePanel(){return this.component.onDidRemovePanel}get onDidLayoutFromJSON(){return this.component.onDidLayoutfromJSON}get onDidLayoutChange(){return this.component.onDidLayoutChange}get onDidDrop(){return this.component.onDidDrop}get panels(){return this.component.panels}get groups(){return this.component.groups}get activePanel(){return this.component.activePanel}get activeGroup(){return this.component.activeGroup}getTabHeight(){return this.component.tabHeight}setTabHeight(e){this.component.tabHeight=e}focus(){this.component.focus()}getPanel(e){return this.component.getGroupPanel(e)}layout(e,t,i=!1){this.component.layout(e,t,i)}addPanel(e){return this.component.addPanel(e)}addEmptyGroup(e){this.component.addEmptyGroup(e)}moveToNext(e){this.component.moveToNext(e)}moveToPrevious(e){this.component.moveToPrevious(e)}closeAllGroups(){return this.component.closeAllGroups()}removeGroup(e){this.component.removeGroup(e)}getGroup(e){return this.component.getPanel(e)}fromJSON(e){this.component.fromJSON(e)}toJSON(){return this.component.toJSON()}}class te extends v{constructor(){super(),this.disposable=new g,this._onDidFocus=new p,this.onDidFocus=this._onDidFocus.event,this._onDidBlur=new p,this.onDidBlur=this._onDidBlur.event,this._element=document.createElement("div"),this._element.className="content-container",this._element.tabIndex=-1,this.addDisposables(this._onDidFocus,this._onDidBlur)}get element(){return this._element}show(){this.element.style.display=""}hide(){this.element.style.display="none"}openPanel(e){var t;if(this.panel===e)return;this.panel&&((null===(t=this.panel.view)||void 0===t?void 0:t.content)&&this._element.removeChild(this.panel.view.content.element),this.panel=void 0),this.panel=e;const i=new v;if(this.panel.view){const e=this.panel.view.content.onDidFocus,t=this.panel.view.content.onDidBlur,{onDidFocus:s,onDidBlur:n}=y(this._element);i.addDisposables(s((()=>this._onDidFocus.fire())),n((()=>this._onDidBlur.fire()))),e&&i.addDisposables(e((()=>this._onDidFocus.fire()))),t&&i.addDisposables(t((()=>this._onDidBlur.fire()))),this._element.appendChild(this.panel.view.content.element)}this.disposable.value=i}layout(e,t){}closePanel(){var e,t,i;(null===(i=null===(t=null===(e=this.panel)||void 0===e?void 0:e.view)||void 0===t?void 0:t.content)||void 0===i?void 0:i.element)&&(this._element.removeChild(this.panel.view.content.element),this.panel=void 0)}dispose(){this.disposable.dispose(),super.dispose()}}var ie,se,ne;!function(e){e[e.Tab=0]="Tab",e[e.Panel=1]="Panel",e[e.TabContainer=2]="TabContainer"}(ie||(ie={}));class oe extends v{constructor(e){super(),this.el=e,this.disposable=new g,this._onDragStart=new p,this.onDragStart=this._onDragStart.event,this.iframes=[],this.configure()}configure(){this.addDisposables(this._onDragStart,u(this.el,"dragstart",(e=>{this.iframes=[...D("iframe"),...D("webview")];for(const t of this.iframes)t.style.pointerEvents="none";this.el.classList.add("dragged"),setTimeout((()=>this.el.classList.remove("dragged")),0),this.disposable.value=this.getData(),e.dataTransfer&&(e.dataTransfer.effectAllowed="move")})),u(this.el,"dragend",(()=>{for(const e of this.iframes)e.style.pointerEvents="auto";this.iframes=[],this.disposable.dispose()})))}}!function(e){e.CLICK="CLICK",e.CONTEXT_MENU="CONTEXT_MENU"}(se||(se={}));class re extends v{constructor(e,t,i){super(),this.panelId=e,this.group=i,this._onChanged=new p,this.onChanged=this._onChanged.event,this._onDropped=new p,this.onDrop=this._onDropped.event,this.addDisposables(this._onChanged,this._onDropped),this._element=document.createElement("div"),this._element.className="tab",this._element.tabIndex=0,this._element.draggable=!0,C(this.element,"inactive-tab",!0),this.addDisposables(new class extends oe{constructor(){super(...arguments),this.panelTransfer=r.getInstance()}getData(){return this.panelTransfer.setData([new n(t.id,i.id,e)],n.prototype),{dispose:()=>{this.panelTransfer.clearData(n.prototype)}}}dispose(){}}(this._element)),this.addDisposables(u(this._element,"mousedown",(e=>{e.defaultPrevented||(e.stopPropagation(),this._onChanged.fire({kind:se.CLICK,event:e}))})),u(this._element,"contextmenu",(e=>{this._onChanged.fire({kind:se.CONTEXT_MENU,event:e})}))),this.droptarget=new F(this._element,{validOverlays:"none",canDisplayOverlay:e=>{const t=a();return t?this.panelId!==t.panelId:this.group.model.canDisplayOverlay(e,ie.Tab)}}),this.addDisposables(this.droptarget.onDrop((e=>{this._onDropped.fire(e)})))}get element(){return this._element}setActive(e){C(this.element,"active-tab",e),C(this.element,"inactive-tab",!e)}setContent(e){this.content&&this._element.removeChild(this.content.element),this.content=e,this._element.appendChild(this.content.element)}dispose(){super.dispose(),this.droptarget.dispose()}}class ae extends v{constructor(e,t,i){super(),this.accessor=e,this.group=t,this.tabs=[],this.selectedIndex=-1,this._hidden=!1,this._onDrop=new p,this.onDrop=this._onDrop.event,this.addDisposables(this._onDrop),this._element=document.createElement("div"),this._element.className="tabs-and-actions-container",this.height=i.tabHeight,this.actionContainer=document.createElement("div"),this.actionContainer.className="action-container",this.tabContainer=document.createElement("div"),this.tabContainer.className="tabs-container",this.voidContainer=document.createElement("div"),this.voidContainer.className="void-container",this._element.appendChild(this.tabContainer),this._element.appendChild(this.voidContainer),this._element.appendChild(this.actionContainer),this.voidDropTarget=new F(this.voidContainer,{validOverlays:"none",canDisplayOverlay:e=>{var i;const s=a();return s?(null===(i=(n=this.tabs).length>0?n[n.length-1]:void 0)||void 0===i?void 0:i.value.panelId)!==s.panelId:t.model.canDisplayOverlay(e,ie.Panel);var n}}),this.addDisposables(this.voidDropTarget.onDrop((e=>{this._onDrop.fire({event:e.nativeEvent,index:this.tabs.length})})),this.voidDropTarget,u(this.tabContainer,"mousedown",(e=>{if(e.defaultPrevented)return;0===e.button&&this.accessor.doSetGroupActive(this.group)})))}get panels(){return this.tabs.map((e=>e.value.panelId))}get size(){return this.tabs.length}get height(){return this._height}set height(e){this._height=e,"number"!=typeof e?this.element.style.removeProperty("--dv-tabs-and-actions-container-height"):this.element.style.setProperty("--dv-tabs-and-actions-container-height",`${e}px`)}get hidden(){return this._hidden}set hidden(e){this._hidden=e,this.element.style.display=e?"none":""}show(){this.hidden||(this.element.style.display="")}hide(){this._element.style.display="none"}setActionElement(e){this.actions!==e&&(this.actions&&(this.actions.remove(),this.actions=void 0),e&&(this.actionContainer.appendChild(e),this.actions=e))}get element(){return this._element}isActive(e){return this.selectedIndex>-1&&this.tabs[this.selectedIndex].value===e}at(e){var t;return null===(t=this.tabs[e])||void 0===t?void 0:t.value}indexOf(e){return this.tabs.findIndex((t=>t.value.panelId===e))}setActive(e){}addTab(e,t=this.tabs.length){if(t<0||t>this.tabs.length)throw new Error("invalid location");this.tabContainer.insertBefore(e.value.element,this.tabContainer.children[t]),this.tabs=[...this.tabs.slice(0,t),e,...this.tabs.slice(t)],this.selectedIndex<0&&(this.selectedIndex=t)}delete(e){const t=this.tabs.findIndex((t=>t.value.panelId===e)),i=this.tabs.splice(t,1)[0],{value:s,disposable:n}=i;n.dispose(),s.element.remove()}setActivePanel(e){this.tabs.forEach((t=>{const i=e.id===t.value.panelId;t.value.setActive(i)}))}openPanel(e,t=this.tabs.length){var i;if(this.tabs.find((t=>t.value.panelId===e.id)))return;const s=new re(e.id,this.accessor,this.group);if(!(null===(i=e.view)||void 0===i?void 0:i.tab))throw new Error("invalid header component");s.setContent(e.view.tab);const n=v.from(s.onChanged((t=>{var i;const s=e.id===(null===(i=this.group.model.activePanel)||void 0===i?void 0:i.id)&&this.group.model.isContentFocused;this.accessor.fireMouseEvent(Object.assign(Object.assign({},t),{panel:e,tab:!0}));0===t.event.button&&!t.event.defaultPrevented&&t.kind===se.CLICK&&this.group.model.openPanel(e,{skipFocus:s})})),s.onDrop((e=>{this._onDrop.fire({event:e.nativeEvent,index:this.tabs.findIndex((e=>e.value===s))})}))),o={value:s,disposable:n};this.addTab(o,t)}closePanel(e){this.delete(e.id)}dispose(){super.dispose(),this.tabs.forEach((e=>{e.disposable.dispose()})),this.tabs=[]}}!function(e){e.ADD_PANEL="ADD_PANEL",e.REMOVE_PANEL="REMOVE_PANEL",e.PANEL_ACTIVE="PANEL_ACTIVE"}(ne||(ne={}));class he extends v{constructor(e,t,i,s,n){super(),this.container=e,this.accessor=t,this.id=i,this.options=s,this.parent=n,this._isGroupActive=!1,this._locked=!1,this.mostRecentlyUsed=[],this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this._width=0,this._height=0,this._panels=[],this._onMove=new p,this.onMove=this._onMove.event,this._onDidGroupChange=new p,this.onDidGroupChange=this._onDidGroupChange.event,this._onDidDrop=new p,this.onDidDrop=this._onDidDrop.event,this.container.classList.add("groupview"),this.addDisposables(this._onMove,this._onDidGroupChange,this._onDidChange,this._onDidDrop),this.tabsContainer=new ae(this.accessor,this.parent,{tabHeight:s.tabHeight}),this.contentContainer=new te,this.dropTarget=new F(this.contentContainer.element,{validOverlays:"all",canDisplayOverlay:(e,t)=>{if(this.locked&&!t)return!1;const i=a();if(i){return!(1===this._panels.length&&i.groupId===this.id)}return this.canDisplayOverlay(e,ie.Panel)}}),e.append(this.tabsContainer.element,this.contentContainer.element),this.header.hidden=!!s.hideHeader,this.locked=!!s.locked,this.addDisposables(this._onMove,this._onDidGroupChange,this.tabsContainer.onDrop((e=>{this.handleDropEvent(e.event,G.Center,e.index)})),this.contentContainer.onDidFocus((()=>{this.accessor.doSetGroupActive(this.parent,!0)})),this.contentContainer.onDidBlur((()=>{})),this.dropTarget.onDrop((e=>{this.handleDropEvent(e.nativeEvent,e.position)})))}get element(){throw new Error("not supported")}get activePanel(){return this._activePanel}get locked(){return this._locked}set locked(e){this._locked=e}get isActive(){return this._isGroupActive}get panels(){return this._panels}get size(){return this._panels.length}get isEmpty(){return 0===this._panels.length}get minimumHeight(){return 100}get maximumHeight(){return Number.MAX_SAFE_INTEGER}get minimumWidth(){return 100}get maximumWidth(){return Number.MAX_SAFE_INTEGER}get hasWatermark(){return!(!this.watermark||!this.container.contains(this.watermark.element))}get header(){return this.tabsContainer}get isContentFocused(){return!!document.activeElement&&b(document.activeElement,this.contentContainer.element)}initialize(){var e,t;(null===(e=this.options)||void 0===e?void 0:e.panels)&&this.options.panels.forEach((e=>{this.doAddPanel(e)})),(null===(t=this.options)||void 0===t?void 0:t.activePanel)&&this.openPanel(this.options.activePanel),this.setActive(this.isActive,!0,!0),this.updateContainer()}indexOf(e){return this.tabsContainer.indexOf(e.id)}toJSON(){var e;const t={views:this.tabsContainer.panels,activeView:null===(e=this._activePanel)||void 0===e?void 0:e.id,id:this.id};return this.locked&&(t.locked=!0),this.header.hidden&&(t.hideHeader=!0),t}moveToNext(e){e||(e={}),e.panel||(e.panel=this.activePanel);const t=e.panel?this.panels.indexOf(e.panel):-1;let i;if(t<this.panels.length-1)i=t+1;else{if(e.suppressRoll)return;i=0}this.openPanel(this.panels[i])}moveToPrevious(e){if(e||(e={}),e.panel||(e.panel=this.activePanel),!e.panel)return;const t=this.panels.indexOf(e.panel);let i;if(t>0)i=t-1;else{if(e.suppressRoll)return;i=this.panels.length-1}this.openPanel(this.panels[i])}containsPanel(e){return this.panels.includes(e)}init(e){}update(e){}focus(){var e;null===(e=this._activePanel)||void 0===e||e.focus()}openPanel(e,t={}){("number"!=typeof t.index||t.index>this.panels.length)&&(t.index=this.panels.length);const i=!!t.skipSetActive;e.updateParentGroup(this.parent,!0),i||this._activePanel!==e?(this.doAddPanel(e,t.index,i),i||(this.doSetActivePanel(e),this.accessor.doSetGroupActive(this.parent,!!t.skipFocus)),this.updateContainer()):this.accessor.doSetGroupActive(this.parent)}removePanel(e){const t="string"==typeof e?e:e.id,i=this._panels.find((e=>e.id===t));if(!i)throw new Error("invalid operation");return this._removePanel(i)}closeAllPanels(){if(this.panels.length>0){const e=[...this.panels];for(const t of e)this.doClose(t)}else this.accessor.removeGroup(this.parent)}closePanel(e){this.doClose(e)}doClose(e){this.accessor.removePanel(e)}isPanelActive(e){return this._activePanel===e}updateActions(){var e,t;this.isActive&&(null===(t=null===(e=this._activePanel)||void 0===e?void 0:e.view)||void 0===t?void 0:t.actions)?this.tabsContainer.setActionElement(this._activePanel.view.actions.element):this.tabsContainer.setActionElement(void 0)}setActive(e,t=!1,i=!1){var s,n;i||this.isActive!==e?(this._isGroupActive=e,C(this.container,"active-group",e),C(this.container,"inactive-group",!e),this.tabsContainer.setActive(this.isActive),!this._activePanel&&this.panels.length>0&&this.doSetActivePanel(this.panels[0]),this.updateContainer(),e&&(t||null===(n=this._activePanel)||void 0===n||n.focus())):t||null===(s=this._activePanel)||void 0===s||s.focus()}layout(e,t){var i;this._width=e,this._height=t,this.contentContainer.layout(this._width,this._height),(null===(i=this._activePanel)||void 0===i?void 0:i.layout)&&this._activePanel.layout(this._width,this._height)}_removePanel(e){const t=this._activePanel===e;if(this.doRemovePanel(e),t&&this.panels.length>0){const e=this.mostRecentlyUsed[0];this.openPanel(e)}return this._activePanel&&0===this.panels.length&&this.doSetActivePanel(void 0),this.updateContainer(),e}doRemovePanel(e){const t=this.panels.indexOf(e);this._activePanel===e&&this.contentContainer.closePanel(),this.tabsContainer.delete(e.id),this._panels.splice(t,1),this.mostRecentlyUsed.includes(e)&&this.mostRecentlyUsed.splice(this.mostRecentlyUsed.indexOf(e),1),this._onDidGroupChange.fire({kind:ne.REMOVE_PANEL,panel:e})}doAddPanel(e,t=this.panels.length,i=!1){const s=this._panels.indexOf(e)>-1;this.tabsContainer.openPanel(e,t),i||this.contentContainer.openPanel(e),this.tabsContainer.show(),this.contentContainer.show(),s||(this.updateMru(e),this.panels.splice(t,0,e),this._onDidGroupChange.fire({kind:ne.ADD_PANEL,panel:e}))}doSetActivePanel(e){this._activePanel=e,e&&(this.tabsContainer.setActivePanel(e),e.layout(this._width,this._height),this.updateMru(e),this._onDidGroupChange.fire({kind:ne.PANEL_ACTIVE,panel:e}))}updateMru(e){this.mostRecentlyUsed.includes(e)&&this.mostRecentlyUsed.splice(this.mostRecentlyUsed.indexOf(e),1),this.mostRecentlyUsed=[e,...this.mostRecentlyUsed]}updateContainer(){if(this.updateActions(),C(this.container,"empty",this.isEmpty),this.panels.forEach((e=>e.updateParentGroup(this.parent,this.isActive))),this.isEmpty&&!this.watermark){const e=this.accessor.createWatermarkComponent();e.init({containerApi:new ee(this.accessor),params:{},title:"",api:null}),this.watermark=e,u(this.watermark.element,"click",(()=>{this.isActive||this.accessor.doSetGroupActive(this.parent)})),this.contentContainer.hide(),this.tabsContainer.hide(),this.container.appendChild(this.watermark.element),this.watermark.updateParentGroup(this.parent,!0)}!this.isEmpty&&this.watermark&&(this.watermark.element.remove(),this.watermark.dispose(),this.watermark=void 0,this.contentContainer.show(),this.tabsContainer.show())}canDisplayOverlay(e,t){return!!this.accessor.options.showDndOverlay&&this.accessor.options.showDndOverlay(e,t)}handleDropEvent(e,t,i){const s=a();if(s){if(-1!==this.tabsContainer.indexOf(s.panelId)&&1===this.tabsContainer.size)return;const{groupId:e,panelId:n}=s;if(this.id===e&&!t){if(this.tabsContainer.indexOf(n)===i)return}this._onMove.fire({target:t,groupId:s.groupId,itemId:s.panelId,index:i})}else this._onDidDrop.fire({nativeEvent:e,position:t,index:i,getData:()=>a()})}dispose(){var e;super.dispose(),null===(e=this.watermark)||void 0===e||e.dispose();for(const t of this.panels)t.dispose();this.dropTarget.dispose(),this.tabsContainer.dispose(),this.contentContainer.dispose()}}const de=E();function le(e){switch(e){case"left":return G.Left;case"right":return G.Right;case"above":return G.Top;case"below":return G.Bottom;default:return G.Center}}class pe extends v{constructor(e,t){super(),this._element=e,this._id=de.next(),this._groups=new Map,this._onDidLayoutChange=new p,this.onDidLayoutChange=this._onDidLayoutChange.event,this._onDidRemoveGroup=new p,this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidAddGroup=new p,this.onDidAddGroup=this._onDidAddGroup.event,this._onDidActiveGroupChange=new p,this.onDidActiveGroupChange=this._onDidActiveGroupChange.event,this._bufferOnDidLayoutChange=new c,this.gridview=new Y(!!t.proportionalLayout,t.styles,t.orientation),this.element.appendChild(this.gridview.element),this.layout(0,0,!0),this.addDisposables(this.gridview.onDidChange((()=>{this._onDidLayoutChange.fire()}))),this.addDisposables(d.any(this.onDidAddGroup,this.onDidRemoveGroup,this.onDidActiveGroupChange)((()=>{this._bufferOnDidLayoutChange.fire()})),this._bufferOnDidLayoutChange.onEvent((()=>{this._onDidLayoutChange.fire()})),this._bufferOnDidLayoutChange)}get id(){return this._id}get element(){return this._element}get size(){return this._groups.size}get groups(){return Array.from(this._groups.values()).map((e=>e.value))}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumHeight(){return this.gridview.minimumHeight}get maximumHeight(){return this.gridview.maximumHeight}get minimumWidth(){return this.gridview.minimumWidth}get maximumWidth(){return this.gridview.maximumWidth}get activeGroup(){return this._activeGroup}setVisible(e,t){this.gridview.setViewVisible($(e.element),t),this._onDidLayoutChange.fire()}isVisible(e){return this.gridview.isViewVisible($(e.element))}doAddGroup(e,t=[0],i){this.gridview.addView(e,null!=i?i:k.Distribute,t),this._onDidAddGroup.fire(e),this.doSetGroupActive(e)}doRemoveGroup(e,t){if(!this._groups.has(e.id))throw new Error("invalid operation");const i=this._groups.get(e.id),s=this.gridview.remove(e,k.Distribute);if(i&&!(null==t?void 0:t.skipDispose)&&(i.disposable.dispose(),i.value.dispose(),this._groups.delete(e.id)),this._onDidRemoveGroup.fire(e),!(null==t?void 0:t.skipActive)&&this._activeGroup===e){const e=Array.from(this._groups.values());this.doSetGroupActive(e.length>0?e[0].value:void 0)}return s}getPanel(e){var t;return null===(t=this._groups.get(e))||void 0===t?void 0:t.value}doSetGroupActive(e,t){this._activeGroup!==e&&(this._activeGroup&&(this._activeGroup.setActive(!1),t||this._activeGroup.focus()),e&&(e.setActive(!0),t||e.focus()),this._activeGroup=e,this._onDidActiveGroupChange.fire(e))}removeGroup(e){this.doRemoveGroup(e)}moveToNext(e){var t;if(e||(e={}),!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}const i=$(e.group.element),s=null===(t=this.gridview.next(i))||void 0===t?void 0:t.view;this.doSetGroupActive(s)}moveToPrevious(e){var t;if(e||(e={}),!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}const i=$(e.group.element),s=null===(t=this.gridview.previous(i))||void 0===t?void 0:t.view;this.doSetGroupActive(s)}layout(e,t,i){(i||e!==this.width||t!==this.height)&&(this.element.style.height=`${t}px`,this.element.style.width=`${e}px`,this.gridview.layout(e,t))}dispose(){super.dispose(),this._onDidActiveGroupChange.dispose(),this._onDidAddGroup.dispose(),this._onDidRemoveGroup.dispose(),this._onDidLayoutChange.dispose();for(const e of this.groups)e.dispose();this.gridview.dispose()}}class me extends v{constructor(e){super(),this.id=e,this._isFocused=!1,this._isActive=!1,this._isVisible=!0,this._width=0,this._height=0,this._onDidDimensionChange=new p({replay:!0}),this.onDidDimensionsChange=this._onDidDimensionChange.event,this._onDidChangeFocus=new p({replay:!0}),this.onDidFocusChange=this._onDidChangeFocus.event,this._onFocusEvent=new p,this.onFocusEvent=this._onFocusEvent.event,this._onDidVisibilityChange=new p({replay:!0}),this.onDidVisibilityChange=this._onDidVisibilityChange.event,this._onVisibilityChange=new p,this.onVisibilityChange=this._onVisibilityChange.event,this._onDidActiveChange=new p({replay:!0}),this.onDidActiveChange=this._onDidActiveChange.event,this._onActiveChange=new p,this.onActiveChange=this._onActiveChange.event,this.addDisposables(this._onDidDimensionChange,this._onDidChangeFocus,this._onDidVisibilityChange,this._onDidActiveChange,this._onFocusEvent,this._onActiveChange,this._onVisibilityChange,this.onDidFocusChange((e=>{this._isFocused=e.isFocused})),this.onDidActiveChange((e=>{this._isActive=e.isActive})),this.onDidVisibilityChange((e=>{this._isVisible=e.isVisible})),this.onDidDimensionsChange((e=>{this._width=e.width,this._height=e.height})))}get isFocused(){return this._isFocused}get isActive(){return this._isActive}get isVisible(){return this._isVisible}get width(){return this._width}get height(){return this._height}setVisible(e){this._onVisibilityChange.fire({isVisible:e})}setActive(){this._onActiveChange.fire()}dispose(){super.dispose()}}class ue extends me{constructor(e){super(e),this._onDidConstraintsChangeInternal=new p,this.onDidConstraintsChangeInternal=this._onDidConstraintsChangeInternal.event,this._onDidConstraintsChange=new p({replay:!0}),this.onDidConstraintsChange=this._onDidConstraintsChange.event,this._onDidSizeChange=new p,this.onDidSizeChange=this._onDidSizeChange.event,this.addDisposables(this._onDidConstraintsChangeInternal,this._onDidConstraintsChange,this._onDidSizeChange)}setConstraints(e){this._onDidConstraintsChangeInternal.fire(e)}setSize(e){this._onDidSizeChange.fire(e)}}class ce extends ue{constructor(e,t){super(e.id),this.panel=e,this._onDidTitleChange=new p,this.onDidTitleChange=this._onDidTitleChange.event,this._titleChanged=new p,this.titleChanged=this._titleChanged.event,this._suppressClosableChanged=new p,this.suppressClosableChanged=this._suppressClosableChanged.event,this._onDidActiveGroupChange=new p,this.onDidActiveGroupChange=this._onDidActiveGroupChange.event,this._onDidGroupChange=new p,this.onDidGroupChange=this._onDidGroupChange.event,this.disposable=new g,this._group=t,this.addDisposables(this.disposable,this._onDidTitleChange,this._titleChanged,this._suppressClosableChanged,this._onDidGroupChange,this._onDidActiveGroupChange)}get title(){return this.panel.title}get suppressClosable(){return!!this.panel.suppressClosable}get isGroupActive(){var e;return!!(null===(e=this.group)||void 0===e?void 0:e.isActive)}set group(e){const t=this.isGroupActive;this._group=e,this._onDidGroupChange.fire(),this._group&&(this.disposable.value=this._group.api.onDidActiveChange((()=>{this._onDidActiveGroupChange.fire()})),this.isGroupActive!==t&&this._onDidActiveGroupChange.fire())}get group(){return this._group}setTitle(e){this._onDidTitleChange.fire({title:e})}close(){if(!this.group)throw new Error(`panel ${this.id} has no group`);return this.group.model.closePanel(this.panel)}}class ve extends v{constructor(e,t,i,s){super(),this.id=e,this.containerApi=i,this.mutableDisposable=new g,this._suppressClosable=!1,this._title="",this._group=s,this.api=new ce(this,this._group),this.addDisposables(this.api.onActiveChange((()=>{t.setActivePanel(this)})),this.api.onDidTitleChange((e=>{const t=e.title;this.update({params:{title:t}})})))}get params(){var e;return null===(e=this._params)||void 0===e?void 0:e.params}get title(){return this._title}get suppressClosable(){return this._suppressClosable}get group(){return this._group}get view(){return this._view}init(e){var t;this._params=e.params,this._view=e.view,this.setTitle(e.title),this.setSuppressClosable(e.suppressClosable||!1),null===(t=this.view)||void 0===t||t.init(Object.assign(Object.assign({},e),{api:this.api,containerApi:this.containerApi}))}focus(){this.api._onFocusEvent.fire()}toJSON(){return{id:this.id,view:this.view.toJSON(),params:Object.keys(this._params||{}).length>0?this._params:void 0,suppressClosable:this.suppressClosable||void 0,title:this.title}}setTitle(e){var t;e!==(null===(t=this._params)||void 0===t?void 0:t.title)&&(this._title=e,this.api._titleChanged.fire({title:this.title}))}setSuppressClosable(e){var t;e!==(null===(t=this._params)||void 0===t?void 0:t.suppressClosable)&&(this._suppressClosable=e,this.api._suppressClosableChanged.fire({suppressClosable:!!this.suppressClosable}))}update(e){var t;const i=e.params;this._params=Object.assign(Object.assign({},this._params||{}),e.params.params),"string"==typeof i.title&&this.setTitle(i.title),"boolean"==typeof i.suppressClosable&&this.setSuppressClosable(i.suppressClosable),null===(t=this.view)||void 0===t||t.update({params:{params:this._params,title:this.title,suppressClosable:this.suppressClosable}})}updateParentGroup(e,t){var i;this._group=e,this.api.group=e;const s=this._group.model.isPanelActive(this);this.api._onDidActiveChange.fire({isActive:t&&s}),this.api._onDidVisibilityChange.fire({isVisible:s}),null===(i=this.view)||void 0===i||i.updateParentGroup(this._group,this._group.model.isPanelActive(this))}layout(e,t){var i;this.api._onDidDimensionChange.fire({width:e,height:t-(this.group.model.header.height||0)}),null===(i=this.view)||void 0===i||i.layout(e,t)}dispose(){var e;this.api.dispose(),this.mutableDisposable.dispose(),null===(e=this.view)||void 0===e||e.dispose()}}class ge{constructor(){this._element=document.createElement("div"),this._element.className="actions-bar",this._list=document.createElement("ul"),this._list.className="actions-container",this._element.appendChild(this._list)}get element(){return this._element}add(e){document.createElement("li").className="action-item",this._list.appendChild(e)}}class we extends v{constructor(){super(),this._element=document.createElement("div"),this._element.className="watermark";const e=document.createElement("div");e.className="watermark-title";const t=document.createElement("span");t.style.flexGrow="1";const i=document.createElement("div");i.className="watermark-content",this._element.appendChild(e),this._element.appendChild(i);const s=new ge;e.appendChild(t),e.appendChild(s.element);const n=document.createElement("a");n.className="close-action",s.add(n),this.addDisposables(u(n,"click",(e=>{var t;e.preventDefault(),this.group&&(null===(t=this.params)||void 0===t||t.containerApi.removeGroup(this.group))})))}get id(){return"watermark"}update(e){}focus(){}toJSON(){return{}}layout(e,t){}init(e){this.params=e,this.addDisposables(this.params.containerApi.onDidLayoutChange((()=>{this.render()}))),this.render()}updateParentGroup(e,t){this.group=e,this.render()}get element(){return this._element}render(){const e=!!(this.params&&this.params.containerApi.size<=1);C(this.element,"has-actions",e)}dispose(){super.dispose()}}class _e{constructor(e,t){this.layout=e,this.panelDeserializer=t}fromJSON(e){const t=e.data,i=t.views,s=t.activeView,n=this.layout.createGroup({id:t.id,locked:!!t.locked,hideHeader:!!t.hideHeader});for(const o of i){const e=this.panelDeserializer.createPanel(o,n),t="string"==typeof s&&s===e.id;n.model.openPanel(e,{skipSetActive:!t})}return!n.activePanel&&n.panels.length>0&&n.model.openPanel(n.panels[n.panels.length-1]),n}}function fe(e,t,i={},s={},n,o){const r="string"==typeof t?i[t]:void 0,a="string"==typeof t?s[t]:void 0;if(r&&a)throw new Error(`Cannot create '${e}'. component '${t}' registered as both a component and frameworkComponent`);if(a){if(!n)throw new Error(`Cannot create '${e}' for framework component '${t}'. you must register a frameworkPanelWrapper to use framework components`);return n.createComponent(e,t,a)}if(!r){if(o)return o();throw new Error(`Cannot create '${e}', no component '${t}' provided`)}return new r(e,t)}class Ce extends v{constructor(){super(),this._isPanelVisible=!1,this._isGroupActive=!1,this.params={},this._element=document.createElement("div"),this._element.className="default-tab",this._content=document.createElement("div"),this._content.className="tab-content",this._actionContainer=document.createElement("div"),this._actionContainer.className="action-container",this._list=document.createElement("ul"),this._list.className="tab-list",this.action=document.createElement("a"),this.action.className="tab-action",this._element.appendChild(this._content),this._element.appendChild(this._actionContainer),this._actionContainer.appendChild(this._list),this._list.appendChild(this.action),this.addDisposables(u(this._actionContainer,"mousedown",(e=>{e.preventDefault()}))),this.render()}get element(){return this._element}get id(){return"__DEFAULT_TAB__"}update(e){this.params=Object.assign(Object.assign({},this.params),e.params),this.render()}toJSON(){return{id:this.id}}focus(){}init(e){this.params=e,this._content.textContent=e.title,this.params.suppressClosable?this.action.classList.add("disable-close"):u(this.action,"click",(e=>{e.preventDefault(),this.params.api.close()}))}updateParentGroup(e,t){const i=this._isPanelVisible!==t||this._isGroupActive!==e.isActive;this._isPanelVisible=t,this._isGroupActive=e.isActive,i&&this.render()}layout(e,t){}render(){this._content.textContent!==this.params.title&&(this._content.textContent=this.params.title)}}class be extends v{constructor(e,t,i){super(),this.id=e,this.component=t,this.api=i,this._height=0,this._width=0,this._element=document.createElement("div"),this._element.tabIndex=-1,this._element.style.outline="none",this._element.style.height="100%",this._element.style.width="100%",this._element.style.overflow="hidden";const{onDidFocus:s,onDidBlur:n}=y(this._element);this.addDisposables(this.api,s((()=>{this.api._onDidChangeFocus.fire({isFocused:!0})})),n((()=>{this.api._onDidChangeFocus.fire({isFocused:!1})})))}get element(){return this._element}get width(){return this._width}get height(){return this._height}get params(){var e;return null===(e=this._params)||void 0===e?void 0:e.params}focus(){this.api._onFocusEvent.fire()}layout(e,t){this._width=e,this._height=t,this.api._onDidDimensionChange.fire({width:e,height:t}),this.part&&this._params&&this.part.update(this._params.params)}init(e){this._params=e,this.part=this.getComponent()}update(e){var t,i;this._params=Object.assign(Object.assign({},this._params),{params:Object.assign(Object.assign({},null===(t=this._params)||void 0===t?void 0:t.params),e.params)}),null===(i=this.part)||void 0===i||i.update({params:this._params.params})}toJSON(){var e,t;const i=null!==(t=null===(e=this._params)||void 0===e?void 0:e.params)&&void 0!==t?t:{};return{id:this.id,component:this.component,params:Object.keys(i).length>0?i:void 0}}dispose(){var e;super.dispose(),this.api.dispose(),null===(e=this.part)||void 0===e||e.dispose()}}class De extends be{constructor(e,t,i=new ue(e)){super(e,t,i),this._evaluatedMinimumWidth=0,this._evaluatedMaximumWidth=Number.MAX_SAFE_INTEGER,this._evaluatedMinimumHeight=0,this._evaluatedMaximumHeight=Number.MAX_SAFE_INTEGER,this._minimumWidth=0,this._minimumHeight=0,this._maximumWidth=Number.MAX_SAFE_INTEGER,this._maximumHeight=Number.MAX_SAFE_INTEGER,this._snap=!1,this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this.addDisposables(this._onDidChange,this.api.onVisibilityChange((e=>{const{isVisible:t}=e,{accessor:i}=this._params;i.setVisible(this,t)})),this.api.onActiveChange((()=>{const{accessor:e}=this._params;e.setActive(this)})),this.api.onDidConstraintsChangeInternal((e=>{"number"!=typeof e.minimumWidth&&"function"!=typeof e.minimumWidth||(this._minimumWidth=e.minimumWidth),"number"!=typeof e.minimumHeight&&"function"!=typeof e.minimumHeight||(this._minimumHeight=e.minimumHeight),"number"!=typeof e.maximumWidth&&"function"!=typeof e.maximumWidth||(this._maximumWidth=e.maximumWidth),"number"!=typeof e.maximumHeight&&"function"!=typeof e.maximumHeight||(this._maximumHeight=e.maximumHeight)})),this.api.onDidSizeChange((e=>{this._onDidChange.fire({height:e.height,width:e.width})})))}get priority(){return this._priority}get snap(){return this._snap}get minimumWidth(){const e="function"==typeof this._minimumWidth?this._minimumWidth():this._minimumWidth;return e!==this._evaluatedMinimumWidth&&(this._evaluatedMinimumWidth=e,this.updateConstraints()),e}get minimumHeight(){const e="function"==typeof this._minimumHeight?this._minimumHeight():this._minimumHeight;return e!==this._evaluatedMinimumHeight&&(this._evaluatedMinimumHeight=e,this.updateConstraints()),e}get maximumHeight(){const e="function"==typeof this._maximumHeight?this._maximumHeight():this._maximumHeight;return e!==this._evaluatedMaximumHeight&&(this._evaluatedMaximumHeight=e,this.updateConstraints()),e}get maximumWidth(){const e="function"==typeof this._maximumWidth?this._maximumWidth():this._maximumWidth;return e!==this._evaluatedMaximumWidth&&(this._evaluatedMaximumWidth=e,this.updateConstraints()),e}get isActive(){return this.api.isActive}setVisible(e){this.api._onDidVisibilityChange.fire({isVisible:e})}setActive(e){this.api._onDidActiveChange.fire({isActive:e})}init(e){e.maximumHeight&&(this._maximumHeight=e.maximumHeight),e.minimumHeight&&(this._minimumHeight=e.minimumHeight),e.maximumWidth&&(this._maximumWidth=e.maximumWidth),e.minimumWidth&&(this._minimumWidth=e.minimumWidth),this._priority=e.priority,this._snap=!!e.snap,super.init(e),"boolean"==typeof e.isVisible&&this.setVisible(e.isVisible)}updateConstraints(){this.api._onDidConstraintsChange.fire({minimumWidth:this._evaluatedMinimumWidth,maximumWidth:this._evaluatedMaximumWidth,minimumHeight:this._evaluatedMinimumHeight,maximumHeight:this._evaluatedMaximumHeight})}toJSON(){const e=super.toJSON(),t=e=>e===Number.MAX_SAFE_INTEGER?void 0:e,i=e=>e<=0?void 0:e;return Object.assign(Object.assign({},e),{minimumHeight:i(this.minimumHeight),maximumHeight:t(this.maximumHeight),minimumWidth:i(this.minimumWidth),maximumWidth:t(this.maximumWidth),snap:this.snap,priority:this.priority})}}class ye extends ue{}class Se extends De{constructor(e,t,i){super(t,"groupview_default",new ye(t)),this._model=new he(this.element,e,t,i,this)}get panels(){return this._model.panels}get activePanel(){return this._model.activePanel}get size(){return this._model.size}get model(){return this._model}get minimumHeight(){return this._model.minimumHeight}get maximumHeight(){return this._model.maximumHeight}get minimumWidth(){return this._model.minimumWidth}get maximumWidth(){return this._model.maximumWidth}get locked(){return this._model.locked}set locked(e){this._model.locked=e}get header(){return this._model.header}initialize(){this._model.initialize()}setActive(e){super.setActive(e),this.model.setActive(e)}layout(e,t){super.layout(e,t),this.model.layout(e,t)}getComponent(){return this._model}toJSON(){return this.model.toJSON()}}class ze{constructor(e){var t;this._content=e.content,this._tab=null!==(t=e.tab)&&void 0!==t?t:new Ce,this._actions=e.actions||(this.content.actions?{element:this.content.actions,dispose:()=>{}}:void 0)}get content(){return this._content}get tab(){return this._tab}get actions(){return this._actions}init(e){this.content.init(Object.assign(Object.assign({},e),{tab:this.tab})),this.tab.init(e)}updateParentGroup(e,t){var i;this._content.updateParentGroup(e,t),null===(i=this._tab)||void 0===i||i.updateParentGroup(e,t)}layout(e,t){this.content.layout(e,t)}update(e){this.content.update(e),this.tab.update(e)}toJSON(){return{content:this.content.toJSON(),tab:this.tab instanceof Ce?void 0:this.tab.toJSON()}}dispose(){var e;this.content.dispose(),this.tab.dispose(),null===(e=this.actions)||void 0===e||e.dispose()}}const Ee=E();class xe extends pe{constructor(e,t){super(e,{proportionalLayout:!0,orientation:t.orientation||I.HORIZONTAL,styles:t.styles}),this._onTabInteractionEvent=new p,this.onTabInteractionEvent=this._onTabInteractionEvent.event,this._onTabContextMenu=new p,this.onTabContextMenu=this._onTabContextMenu.event,this._onDidDrop=new p,this.onDidDrop=this._onDidDrop.event,this._onDidRemovePanel=new p,this.onDidRemovePanel=this._onDidRemovePanel.event,this._onDidAddPanel=new p,this.onDidAddPanel=this._onDidAddPanel.event,this._onDidLayoutfromJSON=new p,this.onDidLayoutfromJSON=this._onDidLayoutfromJSON.event,this._onDidActivePanelChange=new p,this.onDidActivePanelChange=this._onDidActivePanelChange.event,this.addDisposables(this._onTabInteractionEvent,this._onTabContextMenu,this._onDidDrop,d.any(this.onDidAddPanel,this.onDidRemovePanel,this.onDidActivePanelChange)((()=>{this._bufferOnDidLayoutChange.fire()}))),this._options=t,this.options.components||(this.options.components={}),this.options.frameworkComponents||(this.options.frameworkComponents={}),this.options.frameworkTabComponents||(this.options.frameworkTabComponents={}),this.options.tabComponents||(this.options.tabComponents={}),this.options.watermarkComponent||this.options.watermarkFrameworkComponent||(this.options.watermarkComponent=we),this._api=new ee(this)}get totalPanels(){return this.panels.length}get panels(){return this.groups.flatMap((e=>e.panels))}get deserializer(){return this._deserializer}set deserializer(e){this._deserializer=e}get options(){return this._options}get activePanel(){const e=this.activeGroup;if(e)return e.activePanel}set tabHeight(e){this.options.tabHeight=e,this._groups.forEach((t=>{t.value.model.header.height=e}))}get tabHeight(){return this.options.tabHeight}updateOptions(e){const t="string"==typeof e.orientation&&this.options.orientation!==e.orientation;this._options=Object.assign(Object.assign({},this.options),e),t&&(this.gridview.orientation=e.orientation),this.layout(this.gridview.width,this.gridview.height,!0)}focus(){var e;null===(e=this.activeGroup)||void 0===e||e.focus()}getGroupPanel(e){return this.panels.find((t=>t.id===e))}setActivePanel(e){this.doSetGroupActive(e.group),e.group.model.openPanel(e)}moveToNext(e={}){var t;if(!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}if(e.includePanel&&e.group&&e.group.activePanel!==e.group.panels[e.group.panels.length-1])return void e.group.model.moveToNext({suppressRoll:!0});const i=$(e.group.element),s=null===(t=this.gridview.next(i))||void 0===t?void 0:t.view;this.doSetGroupActive(s)}moveToPrevious(e={}){var t;if(!e.group){if(!this.activeGroup)return;e.group=this.activeGroup}if(e.includePanel&&e.group&&e.group.activePanel!==e.group.panels[0])return void e.group.model.moveToPrevious({suppressRoll:!0});const i=$(e.group.element),s=null===(t=this.gridview.previous(i))||void 0===t?void 0:t.view;s&&this.doSetGroupActive(s)}toJSON(){var e;return{grid:this.gridview.serialize(),panels:this.panels.reduce(((e,t)=>(e[t.id]=t.toJSON(),e)),{}),activeGroup:null===(e=this.activeGroup)||void 0===e?void 0:e.id,options:{tabHeight:this.tabHeight}}}fromJSON(e){const t=Array.from(this._groups.values()).map((e=>e.value));for(const r of t)this.removeGroup(r,!0);if(this.gridview.clear(),!this.deserializer)throw new Error("invalid deserializer");const{grid:i,panels:s,options:n,activeGroup:o}=e;if("number"==typeof(null==n?void 0:n.tabHeight)&&(this.tabHeight=n.tabHeight),!this.deserializer)throw new Error("no deserializer provided");if(this.gridview.deserialize(i,new _e(this,{createPanel:(e,t)=>{const i=s[e];return this.deserializer.fromJSON(i,t)}})),"string"==typeof o){const e=this.getPanel(o);e&&this.doSetGroupActive(e)}this.gridview.layout(this.width,this.height),this._onDidLayoutfromJSON.fire()}closeAllGroups(){for(const e of this._groups.entries()){const[t,i]=e;i.value.model.closeAllPanels()}}fireMouseEvent(e){e.kind===se.CONTEXT_MENU&&e.tab&&e.panel&&this._onTabContextMenu.fire({event:e.event,api:this._api,panel:e.panel})}addPanel(e){var t,i;if(this.panels.find((t=>t.id===e.id)))throw new Error(`panel with id ${e.id} already exists`);let s,n;if(null===(t=e.position)||void 0===t?void 0:t.referencePanel){const t=this.getGroupPanel(e.position.referencePanel);if(!t)throw new Error(`referencePanel ${e.position.referencePanel} does not exist`);s=this.findGroup(t)}else s=this.activeGroup;if(s){const t=le((null===(i=e.position)||void 0===i?void 0:i.direction)||"within");if(t===G.Center)n=this.createPanel(e,s),s.model.openPanel(n);else{const i=$(s.element),o=Z(this.gridview.orientation,i,t),r=this.createGroupAtLocation(o);n=this.createPanel(e,r),r.model.openPanel(n)}}else{const t=this.createGroupAtLocation();n=this.createPanel(e,t),t.model.openPanel(n)}return n}removePanel(e,t={removeEmptyGroup:!0,skipDispose:!1}){const i=e.group;if(!i)throw new Error(`cannot remove panel ${e.id}. it's missing a group.`);i.model.removePanel(e),e.dispose();!(1===this.size)&&0===i.size&&t.removeEmptyGroup&&this.removeGroup(i)}createWatermarkComponent(){var e;return fe("watermark-id","watermark-name",this.options.watermarkComponent?{"watermark-name":this.options.watermarkComponent}:{},this.options.watermarkFrameworkComponent?{"watermark-name":this.options.watermarkFrameworkComponent}:{},null===(e=this.options.frameworkComponentFactory)||void 0===e?void 0:e.watermark)}addEmptyGroup(e){const t=this.createGroup();if(e){const i=this.panels.find((t=>t.id===e.referencePanel));if(!i)throw new Error(`reference panel ${e.referencePanel} does not exist`);const s=this.findGroup(i);if(!s)throw new Error(`reference group for reference panel ${e.referencePanel} does not exist`);const n=le(e.direction||"within"),o=$(s.element),r=Z(this.gridview.orientation,o,n);this.doAddGroup(t,r)}else this.doAddGroup(t)}removeGroup(e,t=!1){const i=[...e.panels];for(const s of i)this.removePanel(s,{removeEmptyGroup:!1,skipDispose:!1});super.doRemoveGroup(e,{skipActive:t})}moveGroupOrPanel(e,t,i,s,n){var o;const r=t?null===(o=this._groups.get(t))||void 0===o?void 0:o.value:void 0;if(s&&s!==G.Center){const t=$(e.element),n=Z(this.gridview.orientation,t,s);if(r&&r.size<2){const[t,i]=x(n),o=$(r.element),[a,h]=x(o);if(A(a,t))this.gridview.moveView(a,h,i);else{const t=this.doRemoveGroup(r,{skipActive:!0,skipDispose:!0}),i=$(e.element),n=Z(this.gridview.orientation,i,s);this.doAddGroup(t,n)}}else{const e=(null==r?void 0:r.model.removePanel(i))||this.panels.find((e=>e.id===i));if(!e)throw new Error(`No panel with id ${i}`);const n=Z(this.gridview.orientation,t,s);this.createGroupAtLocation(n).model.openPanel(e)}}else{const t=(null==r?void 0:r.model.removePanel(i))||this.panels.find((e=>e.id===i));if(!t)throw new Error(`No panel with id ${i}`);0===(null==r?void 0:r.model.size)&&this.doRemoveGroup(r),e.model.openPanel(t,{index:n})}}doSetGroupActive(e,t){var i,s;const n=this._activeGroup===e;super.doSetGroupActive(e,t),!n&&(null===(i=this._activeGroup)||void 0===i?void 0:i.activePanel)&&this._onDidActivePanelChange.fire(null===(s=this._activeGroup)||void 0===s?void 0:s.activePanel)}createGroup(e){e||(e={tabHeight:this.tabHeight}),"number"!=typeof e.tabHeight&&(e.tabHeight=this.tabHeight);let t=null==e?void 0:e.id;if(t&&this._groups.has(e.id)&&(console.warn(`Duplicate group id ${null==e?void 0:e.id}. reassigning group id to avoid errors`),t=void 0),!t)for(t=Ee.next();this._groups.has(t);)t=Ee.next();const i=new Se(this,t,e);if(i.init({params:{},accessor:null}),!this._groups.has(i.id)){const e=new v(i.model.onMove((e=>{const{groupId:t,itemId:s,target:n,index:o}=e;this.moveGroupOrPanel(i,t,s,n,o)})),i.model.onDidDrop((e=>{this._onDidDrop.fire(Object.assign(Object.assign({},e),{api:this._api}))})),i.model.onDidGroupChange((e=>{switch(e.kind){case ne.ADD_PANEL:e.panel&&this._onDidAddPanel.fire(e.panel);break;case ne.REMOVE_PANEL:e.panel&&this._onDidRemovePanel.fire(e.panel);break;case ne.PANEL_ACTIVE:this._onDidActivePanelChange.fire(e.panel)}})));this._groups.set(i.id,{value:i,disposable:e})}return i.initialize(),"number"==typeof this.options.tabHeight&&(i.model.header.height=this.options.tabHeight),i}createPanel(e,t){const i=new ze({content:this.createContentComponent(e.id,e.component),tab:this.createTabComponent(e.id,e.tabComponent)}),s=new ve(e.id,this,this._api,t);return s.init({view:i,title:e.title||e.id,suppressClosable:null==e?void 0:e.suppressClosable,params:(null==e?void 0:e.params)||{}}),s}createContentComponent(e,t){var i;return fe(e,t,this.options.components||{},this.options.frameworkComponents,null===(i=this.options.frameworkComponentFactory)||void 0===i?void 0:i.content)}createTabComponent(e,t){var i;return fe(e,t,this.options.tabComponents||{},this.options.frameworkTabComponents,null===(i=this.options.frameworkComponentFactory)||void 0===i?void 0:i.tab,(()=>new Ce))}createGroupAtLocation(e=[0]){const t=this.createGroup();return this.doAddGroup(t,e),t}findGroup(e){var t;return null===(t=Array.from(this._groups.values()).find((t=>t.value.model.containsPanel(e))))||void 0===t?void 0:t.value}dispose(){super.dispose(),this._onDidActivePanelChange.dispose(),this._onDidAddPanel.dispose(),this._onDidRemovePanel.dispose(),this._onDidLayoutfromJSON.dispose()}}class Ae extends pe{constructor(e,t){super(e,{proportionalLayout:t.proportionalLayout,orientation:t.orientation,styles:t.styles}),this._onDidLayoutfromJSON=new p,this.onDidLayoutFromJSON=this._onDidLayoutfromJSON.event,this._options=t,this.options.components||(this.options.components={}),this.options.frameworkComponents||(this.options.frameworkComponents={})}get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get options(){return this._options}get deserializer(){return this._deserializer}set deserializer(e){this._deserializer=e}updateOptions(e){const t="string"==typeof e.orientation&&this.options.orientation!==e.orientation;this._options=Object.assign(Object.assign({},this.options),e),t&&(this.gridview.orientation=e.orientation),this.layout(this.gridview.width,this.gridview.height,!0)}removePanel(e){this.removeGroup(e)}toJSON(){var e;return{grid:this.gridview.serialize(),activePanel:null===(e=this.activeGroup)||void 0===e?void 0:e.id}}setVisible(e,t){this.gridview.setViewVisible($(e.element),t)}setActive(e){this._groups.forEach(((t,i)=>{t.value.setActive(e===t.value)}))}focus(){var e;null===(e=this.activeGroup)||void 0===e||e.focus()}fromJSON(e){const{grid:t,activePanel:i}=e,s=Array.from(this._groups.values());for(const o of s)o.disposable.dispose(),this.doRemoveGroup(o.value,{skipActive:!0});this.gridview.clear();const n=[];if(this.gridview.deserialize(t,{fromJSON:e=>{const{data:t}=e,i=fe(t.id,t.component,this.options.components||{},this.options.frameworkComponents||{},this.options.frameworkComponentFactory?{createComponent:this.options.frameworkComponentFactory.createComponent}:void 0);return n.push((()=>i.init({params:t.params,minimumWidth:t.minimumWidth,maximumWidth:t.maximumWidth,minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight,priority:t.priority,snap:!!t.snap,accessor:this,isVisible:e.visible}))),this.registerPanel(i),i}}),this.layout(this.width,this.height,!0),n.forEach((e=>e())),"string"==typeof i){const e=this.getPanel(i);e&&this.doSetGroupActive(e)}this._onDidLayoutfromJSON.fire()}movePanel(e,t){var i;let s;const n=this.gridview.remove(e),o=null===(i=this._groups.get(t.reference))||void 0===i?void 0:i.value;if(!o)throw new Error(`reference group ${t.reference} does not exist`);const r=le(t.direction);if(r===G.Center)throw new Error(`${r} not supported as an option`);{const e=$(o.element);s=Z(this.gridview.orientation,e,r)}this.doAddGroup(n,s,t.size)}addPanel(e){var t,i;let s=e.location||[0];if(null===(t=e.position)||void 0===t?void 0:t.referencePanel){const t=null===(i=this._groups.get(e.position.referencePanel))||void 0===i?void 0:i.value;if(!t)throw new Error(`reference group ${e.position.referencePanel} does not exist`);const n=le(e.position.direction);if(n===G.Center)throw new Error(`${n} not supported as an option`);{const e=$(t.element);s=Z(this.gridview.orientation,e,n)}}const n=fe(e.id,e.component,this.options.components||{},this.options.frameworkComponents||{},this.options.frameworkComponentFactory?{createComponent:this.options.frameworkComponentFactory.createComponent}:void 0);return n.init({params:e.params||{},minimumWidth:e.minimumWidth,maximumWidth:e.maximumWidth,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,priority:e.priority,snap:!!e.snap,accessor:this,isVisible:!0}),this.registerPanel(n),this.doAddGroup(n,s,e.size),n}registerPanel(e){const t=new v(e.api.onDidFocusChange((t=>{t.isFocused&&this._groups.forEach((t=>{const i=t.value;i!==e?i.setActive(!1):i.setActive(!0)}))})));this._groups.set(e.id,{value:e,disposable:t})}moveGroup(e,t,i){const s=this.getPanel(t);if(!s)throw new Error("invalid operation");const n=$(e.element),o=Z(this.gridview.orientation,n,i),[r,a]=x(o),h=$(s.element),[d,l]=x(h);if(A(d,r))return void this.gridview.moveView(d,l,a);const p=this.doRemoveGroup(s,{skipActive:!0,skipDispose:!0}),m=$(e.element),u=Z(this.gridview.orientation,m,i);this.doAddGroup(p,u)}removeGroup(e){super.removeGroup(e)}dispose(){super.dispose(),this._onDidLayoutfromJSON.dispose()}}class Pe extends v{constructor(e,t){super(),this.element=e,this._disposable=new g,this._panels=new Map,this._onDidLayoutfromJSON=new p,this.onDidLayoutFromJSON=this._onDidLayoutfromJSON.event,this._onDidAddView=new p,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new p,this.onDidRemoveView=this._onDidRemoveView.event,this._onDidLayoutChange=new p,this.onDidLayoutChange=this._onDidLayoutChange.event,this._options=t,t.components||(t.components={}),t.frameworkComponents||(t.frameworkComponents={}),this.splitview=new R(this.element,t),this.addDisposables(this._disposable,this._onDidAddView,this._onDidLayoutfromJSON,this._onDidRemoveView,this._onDidLayoutChange)}get panels(){return this.splitview.getViews()}get options(){return this._options}get length(){return this._panels.size}get orientation(){return this.splitview.orientation}get splitview(){return this._splitview}set splitview(e){this._splitview=e,this._disposable.value=new v(this._splitview.onDidSashEnd((()=>{this._onDidLayoutChange.fire(void 0)})),this._splitview.onDidAddView((e=>this._onDidAddView.fire(e))),this._splitview.onDidRemoveView((e=>this._onDidRemoveView.fire(e))))}get minimumSize(){return this.splitview.minimumSize}get maximumSize(){return this.splitview.maximumSize}get height(){return this.splitview.orientation===I.HORIZONTAL?this.splitview.orthogonalSize:this.splitview.size}get width(){return this.splitview.orientation===I.HORIZONTAL?this.splitview.size:this.splitview.orthogonalSize}updateOptions(e){const t="string"==typeof e.orientation&&this.options.orientation!==e.orientation;this._options=Object.assign(Object.assign({},this.options),e),t&&(this.splitview.orientation=e.orientation),this.splitview.layout(this.splitview.size,this.splitview.orthogonalSize)}focus(){var e;null===(e=this._activePanel)||void 0===e||e.focus()}movePanel(e,t){this.splitview.moveView(e,t)}setVisible(e,t){const i=this.panels.indexOf(e);this.splitview.setViewVisible(i,t)}setActive(e,t){this._activePanel=e,this.panels.filter((t=>t!==e)).forEach((e=>{e.api._onDidActiveChange.fire({isActive:!1}),t||e.focus()})),e.api._onDidActiveChange.fire({isActive:!0}),t||e.focus()}removePanel(e,t){const i=this._panels.get(e.id);if(!i)throw new Error(`unknown splitview panel ${e.id}`);i.disposable.dispose(),i.value.dispose(),this._panels.delete(e.id);const s=this.panels.findIndex((t=>t===e));this.splitview.removeView(s,t);const n=this.panels;n.length>0&&this.setActive(n[n.length-1])}getPanel(e){return this.panels.find((t=>t.id===e))}addPanel(e){if(this._panels.has(e.id))throw new Error(`panel ${e.id} already exists`);const t=fe(e.id,e.component,this.options.components||{},this.options.frameworkComponents||{},this.options.frameworkWrapper?{createComponent:this.options.frameworkWrapper.createComponent}:void 0);t.orientation=this.splitview.orientation,t.init({params:e.params||{},minimumSize:e.minimumSize,maximumSize:e.maximumSize,snap:e.snap,priority:e.priority,accessor:this});const i="number"==typeof e.size?e.size:k.Distribute,s="number"==typeof e.index?e.index:void 0;return this.splitview.addView(t,i,s),this.doAddView(t),this.setActive(t),t}layout(e,t){const[i,s]=this.splitview.orientation===I.HORIZONTAL?[e,t]:[t,e];this.splitview.layout(i,s)}doAddView(e){const t=e.api.onDidFocusChange((t=>{t.isFocused&&this.setActive(e,!0)}));this._panels.set(e.id,{disposable:t,value:e})}toJSON(){var e;return{views:this.splitview.getViews().map(((e,t)=>({size:this.splitview.getViewSize(t),data:e.toJSON(),snap:!!e.snap,priority:e.priority}))),activeView:null===(e=this._activePanel)||void 0===e?void 0:e.id,size:this.splitview.size,orientation:this.splitview.orientation}}fromJSON(e){const{views:t,orientation:i,size:s,activeView:n}=e;for(const[r,a]of this._panels.entries())a.disposable.dispose(),a.value.dispose();this._panels.clear(),this.splitview.dispose();const o=[];if(this.splitview=new R(this.element,{orientation:i,proportionalLayout:this.options.proportionalLayout,descriptor:{size:s,views:t.map((e=>{const t=e.data;if(this._panels.has(t.id))throw new Error(`panel ${t.id} already exists`);const s=fe(t.id,t.component,this.options.components||{},this.options.frameworkComponents||{},this.options.frameworkWrapper?{createComponent:this.options.frameworkWrapper.createComponent}:void 0);return o.push((()=>{s.init({params:t.params||{},minimumSize:t.minimumSize,maximumSize:t.maximumSize,snap:e.snap,priority:e.priority,accessor:this})})),s.orientation=i,this.doAddView(s),setTimeout((()=>{this._onDidAddView.fire(s)}),0),{size:e.size,view:s}}))}}),this.layout(this.width,this.height),o.forEach((e=>e())),"string"==typeof n){const e=this.getPanel(n);e&&this.setActive(e)}this._onDidLayoutfromJSON.fire()}dispose(){for(const[e,t]of this._panels.entries())t.disposable.dispose(),t.value.dispose();this._panels.clear(),this.splitview.dispose(),super.dispose()}}class Oe extends me{constructor(e){super(e),this._onDidConstraintsChangeInternal=new p,this.onDidConstraintsChangeInternal=this._onDidConstraintsChangeInternal.event,this._onDidConstraintsChange=new p({replay:!0}),this.onDidConstraintsChange=this._onDidConstraintsChange.event,this._onDidSizeChange=new p,this.onDidSizeChange=this._onDidSizeChange.event,this.addDisposables(this._onDidConstraintsChangeInternal,this._onDidConstraintsChange,this._onDidSizeChange)}setConstraints(e){this._onDidConstraintsChangeInternal.fire(e)}setSize(e){this._onDidSizeChange.fire(e)}}class Ne extends Oe{constructor(e){super(e),this._onDidExpansionChange=new p({replay:!0}),this.onDidExpansionChange=this._onDidExpansionChange.event,this._onMouseEnter=new p({}),this.onMouseEnter=this._onMouseEnter.event,this._onMouseLeave=new p({}),this.onMouseLeave=this._onMouseLeave.event,this.addDisposables(this._onDidExpansionChange,this._onMouseEnter,this._onMouseLeave)}set pane(e){this._pane=e}setExpanded(e){var t;null===(t=this._pane)||void 0===t||t.setExpanded(e)}get isExpanded(){var e;return!!(null===(e=this._pane)||void 0===e?void 0:e.isExpanded())}}class Ve extends be{constructor(e,t,i,s,n,o){super(e,t,new Ne(e)),this.headerComponent=i,this._onDidChangeExpansionState=new p({replay:!0}),this.onDidChangeExpansionState=this._onDidChangeExpansionState.event,this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this.headerSize=22,this._orthogonalSize=0,this._size=0,this._minimumBodySize=100,this._maximumBodySize=Number.POSITIVE_INFINITY,this._isExpanded=!1,this.expandedSize=0,this.api.pane=this,this._isExpanded=n,this._headerVisible=o,this._onDidChangeExpansionState.fire(this.isExpanded()),this._orientation=s,this.element.classList.add("pane"),this.addDisposables(this.api.onDidSizeChange((e=>{this._onDidChange.fire(e.size)})),u(this.element,"mouseenter",(e=>{this.api._onMouseEnter.fire(e)})),u(this.element,"mouseleave",(e=>{this.api._onMouseLeave.fire(e)}))),this.addDisposables(this._onDidChangeExpansionState,this.onDidChangeExpansionState((e=>{this.api._onDidExpansionChange.fire({isExpanded:e})})),this.api.onDidFocusChange((e=>{this.header&&(e.isFocused?f(this.header,"focused"):_(this.header,"focused"))}))),this.renderOnce()}set orientation(e){this._orientation=e}get orientation(){return this._orientation}get minimumSize(){return this.headerSize+(this.isExpanded()?this._minimumBodySize:0)}get maximumSize(){return this.headerSize+(this.isExpanded()?this._maximumBodySize:0)}get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}set orthogonalSize(e){this._orthogonalSize=e}get minimumBodySize(){return this._minimumBodySize}set minimumBodySize(e){this._minimumBodySize="number"==typeof e?e:0}get maximumBodySize(){return this._maximumBodySize}set maximumBodySize(e){this._maximumBodySize="number"==typeof e?e:Number.POSITIVE_INFINITY}get headerVisible(){return this._headerVisible}set headerVisible(e){this._headerVisible=e,this.header.style.display=e?"":"none"}setVisible(e){this.api._onDidVisibilityChange.fire({isVisible:e})}setActive(e){this.api._onDidActiveChange.fire({isActive:e})}isExpanded(){return this._isExpanded}setExpanded(e){this._isExpanded!==e&&(this._isExpanded=e,e?(this.animationTimer&&clearTimeout(this.animationTimer),this.body&&this.element.appendChild(this.body)):this.animationTimer=setTimeout((()=>{var e;null===(e=this.body)||void 0===e||e.remove()}),200),this._onDidChange.fire(e?this.width:void 0),this._onDidChangeExpansionState.fire(e))}layout(e,t){this._size=e,this._orthogonalSize=t;const[i,s]=this.orientation===I.HORIZONTAL?[e,t]:[t,e];this.isExpanded()&&(this.expandedSize=i),super.layout(i,s)}init(e){var t,i;super.init(e),"number"==typeof e.minimumBodySize&&(this.minimumBodySize=e.minimumBodySize),"number"==typeof e.maximumBodySize&&(this.maximumBodySize=e.maximumBodySize),this.bodyPart=this.getBodyComponent(),this.headerPart=this.getHeaderComponent(),this.bodyPart.init(Object.assign(Object.assign({},e),{api:this.api})),this.headerPart.init(Object.assign(Object.assign({},e),{api:this.api})),null===(t=this.body)||void 0===t||t.append(this.bodyPart.element),null===(i=this.header)||void 0===i||i.append(this.headerPart.element),"boolean"==typeof e.isExpanded&&this.setExpanded(e.isExpanded)}toJSON(){const e=this._params;return Object.assign(Object.assign({},super.toJSON()),{headerComponent:this.headerComponent,title:e.title})}renderOnce(){this.header=document.createElement("div"),this.header.tabIndex=0,this.header.className="pane-header",this.header.style.height=`${this.headerSize}px`,this.header.style.lineHeight=`${this.headerSize}px`,this.header.style.minHeight=`${this.headerSize}px`,this.header.style.maxHeight=`${this.headerSize}px`,this.element.appendChild(this.header),this.body=document.createElement("div"),this.body.className="pane-body",this.element.appendChild(this.body)}getComponent(){return{update:e=>{var t,i;null===(t=this.bodyPart)||void 0===t||t.update({params:e}),null===(i=this.headerPart)||void 0===i||i.update({params:e})},dispose:()=>{var e,t;null===(e=this.bodyPart)||void 0===e||e.dispose(),null===(t=this.headerPart)||void 0===t||t.dispose()}}}}class Ie extends Ve{constructor(e,t,i,s,n,o){super(e,t,i,s,n,!0),this._onDidDrop=new p,this.onDidDrop=this._onDidDrop.event,o||this.initDragFeatures()}initDragFeatures(){if(!this.header)return;const e=this.id;this.header.draggable=!0,this.handler=new class extends oe{getData(){return r.getInstance().setData([new o("paneview",e)],o.prototype),{dispose:()=>{r.getInstance().clearData(o.prototype)}}}}(this.header),this.target=new F(this.element,{validOverlays:"vertical",canDisplayOverlay:()=>{const e=h();return!e||e.paneId!==this.id}}),this.addDisposables(this._onDidDrop,this.handler,this.target,this.target.onDrop((e=>{this.onDrop(e)})))}onDrop(e){const t=h();if(!t)return void this._onDidDrop.fire(Object.assign(Object.assign({},e),{panel:this,getData:()=>h()}));const i=this._params.containerApi,s=t.paneId,n=i.getPanel(s);if(!n)return void this._onDidDrop.fire(Object.assign(Object.assign({},e),{panel:this,getData:()=>h()}));const o=i.panels,r=o.indexOf(n);let a=i.panels.indexOf(this);e.position!==G.Left&&e.position!==G.Top||(a=Math.max(0,a-1)),e.position!==G.Right&&e.position!==G.Bottom||(r>a&&a++,a=Math.min(o.length-1,a)),i.movePanel(r,a)}}class Le extends v{constructor(){super(),this.disposable=new g,this.apiRef={api:null},this._element=document.createElement("div"),this.element.className="default-header",this._content=document.createElement("span"),this._expander=document.createElement("a"),this.element.appendChild(this._content),this.element.appendChild(this._expander),this.addDisposables(u(this._expander,"click",(()=>{var e;null===(e=this.apiRef.api)||void 0===e||e.setExpanded(!this.apiRef.api.isExpanded)})))}get element(){return this._element}init(e){this.apiRef.api=e.api,this._content.textContent=e.title,this._expander.textContent=e.api.isExpanded?"<":">",this.disposable.value=e.api.onDidExpansionChange((e=>{this._expander.textContent=e.isExpanded?"<":">"}))}update(e){}dispose(){this.disposable.dispose(),super.dispose()}}class Te extends Ie{constructor(e){super(e.id,e.component,e.headerComponent,e.orientation,e.isExpanded,e.disableDnd),this.options=e}getBodyComponent(){return this.options.body}getHeaderComponent(){return this.options.header}}class ke extends v{constructor(e,t){super(),this.element=e,this._disposable=new g,this._viewDisposables=new Map,this._onDidLayoutfromJSON=new p,this.onDidLayoutFromJSON=this._onDidLayoutfromJSON.event,this._onDidLayoutChange=new p,this.onDidLayoutChange=this._onDidLayoutChange.event,this._onDidDrop=new p,this.onDidDrop=this._onDidDrop.event,this._onDidAddView=new p,this.onDidAddView=this._onDidAddView.event,this._onDidRemoveView=new p,this.onDidRemoveView=this._onDidRemoveView.event,this.addDisposables(this._onDidLayoutChange,this._onDidLayoutfromJSON,this._onDidDrop,this._onDidAddView,this._onDidRemoveView),this._options=t,t.components||(t.components={}),t.frameworkComponents||(t.frameworkComponents={}),this.paneview=new H(this.element,{orientation:I.VERTICAL}),this.addDisposables(this._disposable)}get panels(){return this.paneview.getPanes()}set paneview(e){this._paneview=e,this._disposable.value=new v(this._paneview.onDidChange((()=>{this._onDidLayoutChange.fire(void 0)})),this._paneview.onDidAddView((e=>this._onDidAddView.fire(e))),this._paneview.onDidRemoveView((e=>this._onDidRemoveView.fire(e))))}get paneview(){return this._paneview}get minimumSize(){return this.paneview.minimumSize}get maximumSize(){return this.paneview.maximumSize}get height(){return this.paneview.orientation===I.HORIZONTAL?this.paneview.orthogonalSize:this.paneview.size}get width(){return this.paneview.orientation===I.HORIZONTAL?this.paneview.size:this.paneview.orthogonalSize}get options(){return this._options}focus(){}updateOptions(e){this._options=Object.assign(Object.assign({},this.options),e)}addPanel(e){const t=fe(e.id,e.component,this.options.components||{},this.options.frameworkComponents||{},this.options.frameworkWrapper?{createComponent:this.options.frameworkWrapper.body.createComponent}:void 0);let i;i=e.headerComponent?fe(e.id,e.headerComponent,this.options.headerComponents||{},this.options.headerframeworkComponents,this.options.frameworkWrapper?{createComponent:this.options.frameworkWrapper.header.createComponent}:void 0):new Le;const s=new Te({id:e.id,component:e.component,headerComponent:e.headerComponent,header:i,body:t,orientation:I.VERTICAL,isExpanded:!!e.isExpanded,disableDnd:!!this.options.disableDnd});this.doAddPanel(s);const n="number"==typeof e.size?e.size:k.Distribute,o="number"==typeof e.index?e.index:void 0;return s.init({params:e.params||{},minimumBodySize:e.minimumBodySize,maximumBodySize:e.maximumBodySize,isExpanded:e.isExpanded,title:e.title,containerApi:new Q(this)}),this.paneview.addPane(s,n,o),s.orientation=this.paneview.orientation,s}removePanel(e){const t=this.panels.findIndex((t=>t===e));this.paneview.removePane(t),this.doRemovePanel(e)}movePanel(e,t){this.paneview.moveView(e,t)}getPanel(e){return this.panels.find((t=>t.id===e))}layout(e,t){const[i,s]=this.paneview.orientation===I.HORIZONTAL?[e,t]:[t,e];this.paneview.layout(i,s)}toJSON(){const e=e=>e===Number.MAX_SAFE_INTEGER||e===Number.POSITIVE_INFINITY?void 0:e;return{views:this.paneview.getPanes().map(((t,i)=>{return{size:this.paneview.getViewSize(i),data:t.toJSON(),minimumSize:(s=t.minimumBodySize,s<=0?void 0:s),maximumSize:e(t.maximumBodySize),expanded:t.isExpanded()};var s})),size:this.paneview.size}}fromJSON(e){const{views:t,size:i}=e,s=[];for(const[n,o]of this._viewDisposables.entries())o.dispose();this._viewDisposables.clear(),this.paneview.dispose(),this.paneview=new H(this.element,{orientation:I.VERTICAL,descriptor:{size:i,views:t.map((e=>{const t=e.data,i=fe(t.id,t.component,this.options.components||{},this.options.frameworkComponents||{},this.options.frameworkWrapper?{createComponent:this.options.frameworkWrapper.body.createComponent}:void 0);let n;n=t.headerComponent?fe(t.id,t.headerComponent,this.options.headerComponents||{},this.options.headerframeworkComponents||{},this.options.frameworkWrapper?{createComponent:this.options.frameworkWrapper.header.createComponent}:void 0):new Le;const o=new Te({id:t.id,component:t.component,headerComponent:t.headerComponent,header:n,body:i,orientation:I.VERTICAL,isExpanded:!!e.expanded,disableDnd:!!this.options.disableDnd});return this.doAddPanel(o),s.push((()=>{o.init({params:t.params||{},minimumBodySize:e.minimumSize,maximumBodySize:e.maximumSize,title:t.title,isExpanded:!!e.expanded,containerApi:new Q(this)}),o.orientation=this.paneview.orientation})),setTimeout((()=>{this._onDidAddView.fire(o)}),0),{size:e.size,view:o}}))}}),this.layout(this.width,this.height),s.forEach((e=>e())),this._onDidLayoutfromJSON.fire()}doAddPanel(e){const t=e.onDidDrop((e=>{this._onDidDrop.fire(e)}));this._viewDisposables.set(e.id,t)}doRemovePanel(e){const t=this._viewDisposables.get(e.id);t&&(t.dispose(),this._viewDisposables.delete(e.id))}dispose(){super.dispose();for(const[e,t]of this._viewDisposables.entries())t.dispose();this._viewDisposables.clear(),this.paneview.dispose()}}class Ge extends be{constructor(e,t){super(e,t,new Oe(e)),this._evaluatedMinimumSize=0,this._evaluatedMaximumSize=Number.POSITIVE_INFINITY,this._minimumSize=0,this._maximumSize=Number.POSITIVE_INFINITY,this._snap=!1,this._onDidChange=new p,this.onDidChange=this._onDidChange.event,this.addDisposables(this._onDidChange,this.api.onVisibilityChange((e=>{const{isVisible:t}=e,{accessor:i}=this._params;i.setVisible(this,t)})),this.api.onActiveChange((()=>{const{accessor:e}=this._params;e.setActive(this)})),this.api.onDidConstraintsChangeInternal((e=>{"number"!=typeof e.minimumSize&&"function"!=typeof e.minimumSize||(this._minimumSize=e.minimumSize),"number"!=typeof e.maximumSize&&"function"!=typeof e.maximumSize||(this._maximumSize=e.maximumSize),this.updateConstraints()})),this.api.onDidSizeChange((e=>{this._onDidChange.fire(e.size)})))}get priority(){return this._priority}set orientation(e){this._orientation=e}get orientation(){return this._orientation}get minimumSize(){const e="function"==typeof this._minimumSize?this._minimumSize():this._minimumSize;return e!==this._evaluatedMinimumSize&&(this._evaluatedMinimumSize=e,this.updateConstraints()),e}get maximumSize(){const e="function"==typeof this._maximumSize?this._maximumSize():this._maximumSize;return e!==this._evaluatedMaximumSize&&(this._evaluatedMaximumSize=e,this.updateConstraints()),e}get snap(){return this._snap}setVisible(e){this.api._onDidVisibilityChange.fire({isVisible:e})}setActive(e){this.api._onDidActiveChange.fire({isActive:e})}layout(e,t){const[i,s]=this.orientation===I.HORIZONTAL?[e,t]:[t,e];super.layout(i,s)}init(e){super.init(e),this._priority=e.priority,e.minimumSize&&(this._minimumSize=e.minimumSize),e.maximumSize&&(this._maximumSize=e.maximumSize),e.snap&&(this._snap=e.snap)}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{minimumSize:(e=this.minimumSize,e<=0?void 0:e),maximumSize:(e=>e===Number.MAX_SAFE_INTEGER||e===Number.POSITIVE_INFINITY?void 0:e)(this.maximumSize)});var e}updateConstraints(){this.api._onDidConstraintsChange.fire({maximumSize:this._evaluatedMaximumSize,minimumSize:this._evaluatedMinimumSize})}}var Re=i(7294),He=i(3935);const Me=(e,t)=>{const[i,s]=Re.useState(),n=Re.useRef(e.componentProps);return Re.useImperativeHandle(t,(()=>({update:e=>{n.current=Object.assign(Object.assign({},n.current),e),s(Date.now())}})),[]),Re.createElement(e.component,n.current)};Me.displayName="DockviewReactJsBridge";const Fe=E(),We=Re.createContext({});class Je{constructor(e,t,i,s,n){this.parent=e,this.portalStore=t,this.component=i,this.parameters=s,this.context=n,this.disposed=!1,this.createPortal()}update(e){var t;if(this.disposed)throw new Error("invalid operation: resource is already disposed");null===(t=this.componentInstance)||void 0===t||t.update(e)}createPortal(){if(this.disposed)throw new Error("invalid operation: resource is already disposed");if("function"!=typeof this.component)throw new Error("Invalid Operation. dockview only supports React Functional Components.");const e=Re.createElement(Re.forwardRef(Me),{component:this.component,componentProps:this.parameters,ref:e=>{this.componentInstance=e}}),t=this.context?Re.createElement(We.Provider,{value:this.context},e):e,i=He.createPortal(t,this.parent,Fe.next());this.ref={portal:i,disposable:this.portalStore.addPortal(i)}}dispose(){var e;null===(e=this.ref)||void 0===e||e.disposable.dispose(),this.disposed=!0}}const Be=()=>{const[e,t]=Re.useState([]);Re.useDebugValue(`Portal count: ${e.length}`);return[e,Re.useCallback((e=>{t((t=>[...t,e]));let i=!1;return{dispose:()=>{if(i)throw new Error("invalid operation: resource already disposed");i=!0,t((t=>t.filter((t=>t!==e))))}}}),[])]};class je{constructor(e,t,i){this.id=e,this.component=t,this.reactPortalStore=i,this._onDidFocus=new p,this.onDidFocus=this._onDidFocus.event,this._onDidBlur=new p,this.onDidBlur=this._onDidBlur.event,this._element=document.createElement("div"),this._element.className="dockview-react-part",this._actionsElement=document.createElement("div"),this._actionsElement.className="dockview-react-part"}get element(){return this._element}get actions(){return this._actionsElement}focus(){}init(e){const t={api:e.api,containerApi:e.containerApi,actionsPortalElement:this._actionsElement,tabPortalElement:e.tab};this.part=new Je(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,containerApi:e.containerApi},t)}toJSON(){return{id:this.id}}update(e){var t;null===(t=this.part)||void 0===t||t.update(e.params)}updateParentGroup(e,t){this._group=e}layout(e,t){}dispose(){var e,t;this._onDidFocus.dispose(),this._onDidBlur.dispose(),null===(e=this.part)||void 0===e||e.dispose(),null===(t=this.actionsPart)||void 0===t||t.dispose()}}class $e{constructor(e,t,i){this.id=e,this.component=t,this.reactPortalStore=i,this._element=document.createElement("div"),this._element.className="dockview-react-part"}get element(){return this._element}focus(){}init(e){this.part=new Je(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,containerApi:e.containerApi})}update(e){var t;null===(t=this.part)||void 0===t||t.update(e.params)}toJSON(){return{id:this.id}}layout(e,t){}updateParentGroup(e,t){}dispose(){var e;null===(e=this.part)||void 0===e||e.dispose()}}class Ze{constructor(e){this.layout=e}fromJSON(e,t){var i,s,n;const o=e.id,r=e.params,a=e.title,h=e.suppressClosable,d=e.view,l=new ze({content:fe(d.content.id,d.content.id,this.layout.options.components,this.layout.options.frameworkComponents,null===(i=this.layout.options.frameworkComponentFactory)||void 0===i?void 0:i.content),tab:(null===(s=d.tab)||void 0===s?void 0:s.id)?fe(d.tab.id,d.tab.id,this.layout.options.tabComponents,this.layout.options.frameworkTabComponents,null===(n=this.layout.options.frameworkComponentFactory)||void 0===n?void 0:n.tab):new Ce}),p=new ve(o,this.layout,new ee(this.layout),t);return p.init({view:l,title:a,suppressClosable:h,params:r||{}}),p}}class Ue{constructor(e,t,i){this.id=e,this.component=t,this.reactPortalStore=i,this._groupRef={value:void 0},this._element=document.createElement("div"),this._element.className="dockview-react-part"}get element(){return this._element}init(e){this.parameters=e,this.part=new Je(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,containerApi:e.containerApi,close:()=>{this._groupRef.value&&e.containerApi.removeGroup(this._groupRef.value)}})}focus(){}update(e){var t,i;this.parameters&&(this.parameters.params=e.params),null===(t=this.part)||void 0===t||t.update({params:(null===(i=this.parameters)||void 0===i?void 0:i.params)||{}})}toJSON(){return{id:this.id}}layout(e,t){}updateParentGroup(e,t){this._groupRef.value=e}dispose(){var e;null===(e=this.part)||void 0===e||e.dispose()}}const Xe=Re.forwardRef(((e,t)=>{const i=Re.useRef(null),s=Re.useRef(),[n,o]=Be();return Re.useImperativeHandle(t,(()=>i.current),[]),Re.useEffect((()=>{if(e.disableAutoResizing)return()=>{};const t=w(i.current,(e=>{var t;const{width:i,height:n}=e.contentRect;null===(t=s.current)||void 0===t||t.layout(i,n)}));return()=>{t.dispose()}}),[e.disableAutoResizing]),Re.useEffect((()=>{var t;const n={content:{createComponent:(e,t,i)=>new je(t,i,{addPortal:o})},tab:{createComponent:(e,t,i)=>new $e(t,i,{addPortal:o})},watermark:{createComponent:(e,t,i)=>new Ue(t,i,{addPortal:o})}},r=document.createElement("div"),a=new xe(r,{frameworkComponentFactory:n,frameworkComponents:e.components,frameworkTabComponents:e.tabComponents,tabHeight:e.tabHeight,watermarkFrameworkComponent:e.watermarkComponent,styles:e.hideBorders?{separatorBorder:"transparent"}:void 0});null===(t=i.current)||void 0===t||t.appendChild(a.element),a.deserializer=new Ze(a);const{clientWidth:h,clientHeight:d}=i.current;return a.layout(h,d),e.onReady&&e.onReady({api:new ee(a)}),s.current=a,()=>{a.dispose(),r.remove()}}),[]),Re.useEffect((()=>{if(!s.current)return()=>{};const t=s.current.onDidDrop((t=>{e.onDidDrop&&e.onDidDrop(t)}));return()=>{t.dispose()}}),[e.onDidDrop]),Re.useEffect((()=>{s.current&&s.current.updateOptions({frameworkComponents:e.components})}),[e.components]),Re.useEffect((()=>{s.current&&s.current.updateOptions({watermarkFrameworkComponent:e.watermarkComponent})}),[e.watermarkComponent]),Re.useEffect((()=>{s.current&&s.current.updateOptions({showDndOverlay:e.showDndOverlay})}),[e.showDndOverlay]),Re.useEffect((()=>{s.current&&s.current.updateOptions({frameworkTabComponents:e.tabComponents})}),[e.tabComponents]),Re.useEffect((()=>{if(!e.onTabContextMenu||!s.current)return()=>{};const t=s.current.onTabContextMenu((t=>{e.onTabContextMenu&&e.onTabContextMenu(t)}));return()=>{t.dispose()}}),[e.onTabContextMenu]),Re.createElement("div",{className:e.className,style:{height:"100%",width:"100%"},ref:i},n)}));Xe.displayName="DockviewComponent";class Ye extends Ge{constructor(e,t,i,s){super(e,t),this.reactComponent=i,this.reactPortalStore=s}getComponent(){var e;return new Je(this.element,this.reactPortalStore,this.reactComponent,{params:(null===(e=this._params)||void 0===e?void 0:e.params)||{},api:this.api,containerApi:new K(this._params.accessor)})}}const Ke=Re.forwardRef(((e,t)=>{const i=Re.useRef(null),s=Re.useRef(),[n,o]=Be();return Re.useImperativeHandle(t,(()=>i.current),[]),Re.useEffect((()=>{if(e.disableAutoResizing)return()=>{};const t=w(i.current,(e=>{var t;const{width:i,height:n}=e.contentRect;null===(t=s.current)||void 0===t||t.layout(i,n)}));return()=>{t.dispose()}}),[e.disableAutoResizing]),Re.useEffect((()=>{const t=new Pe(i.current,{orientation:e.orientation||I.HORIZONTAL,frameworkComponents:e.components,frameworkWrapper:{createComponent:(e,t,i)=>new Ye(e,t,i,{addPortal:o})},proportionalLayout:"boolean"!=typeof e.proportionalLayout||e.proportionalLayout,styles:e.hideBorders?{separatorBorder:"transparent"}:void 0}),{clientWidth:n,clientHeight:r}=i.current;return t.layout(n,r),e.onReady&&e.onReady({api:new K(t)}),s.current=t,()=>{t.dispose()}}),[]),Re.useEffect((()=>{s.current&&s.current.updateOptions({frameworkComponents:e.components})}),[e.components]),Re.createElement("div",{className:e.className,style:{height:"100%",width:"100%"},ref:i},n)}));Ke.displayName="SplitviewComponent";class Qe extends De{constructor(e,t,i,s){super(e,t),this.reactComponent=i,this.reactPortalStore=s}getComponent(){var e;return new Je(this.element,this.reactPortalStore,this.reactComponent,{params:(null===(e=this._params)||void 0===e?void 0:e.params)||{},api:this.api,containerApi:new q(this._params.accessor)})}}const qe=Re.forwardRef(((e,t)=>{const i=Re.useRef(null),s=Re.useRef(),[n,o]=Be();return Re.useImperativeHandle(t,(()=>i.current),[]),Re.useEffect((()=>{if(e.disableAutoResizing)return()=>{};const t=w(i.current,(e=>{var t;const{width:i,height:n}=e.contentRect;null===(t=s.current)||void 0===t||t.layout(i,n)}));return()=>{t.dispose()}}),[e.disableAutoResizing]),Re.useEffect((()=>{var t;const n=document.createElement("div"),r=new Ae(n,{proportionalLayout:"boolean"!=typeof e.proportionalLayout||e.proportionalLayout,orientation:e.orientation||I.HORIZONTAL,frameworkComponents:e.components,frameworkComponentFactory:{createComponent:(e,t,i)=>new Qe(e,t,i,{addPortal:o})},styles:e.hideBorders?{separatorBorder:"transparent"}:void 0});null===(t=i.current)||void 0===t||t.appendChild(r.element);const{clientWidth:a,clientHeight:h}=i.current;return r.layout(a,h),e.onReady&&e.onReady({api:new q(r)}),s.current=r,()=>{r.dispose(),n.remove()}}),[]),Re.useEffect((()=>{s.current&&s.current.updateOptions({frameworkComponents:e.components})}),[e.components]),Re.createElement("div",{className:e.className,style:{height:"100%",width:"100%"},ref:i},n)}));qe.displayName="GridviewComponent";class et{constructor(e,t,i){this.id=e,this.component=t,this.reactPortalStore=i,this._element=document.createElement("div"),this._element.style.height="100%",this._element.style.width="100%"}get element(){return this._element}init(e){this.part=new Je(this.element,this.reactPortalStore,this.component,{params:e.params,api:e.api,title:e.title,containerApi:e.containerApi})}toJSON(){return{id:this.id}}update(e){var t;null===(t=this.part)||void 0===t||t.update(e.params)}dispose(){var e;null===(e=this.part)||void 0===e||e.dispose()}}const tt=Re.forwardRef(((e,t)=>{const i=Re.useRef(null),s=Re.useRef(),[n,o]=Be();return Re.useImperativeHandle(t,(()=>i.current),[]),Re.useEffect((()=>{if(e.disableAutoResizing)return()=>{};const t=w(i.current,(e=>{var t;const{width:i,height:n}=e.contentRect;null===(t=s.current)||void 0===t||t.layout(i,n)}));return()=>{t.dispose()}}),[e.disableAutoResizing]),Re.useEffect((()=>{const t=(e,t,i)=>new et(e,i,{addPortal:o}),n=new ke(i.current,{frameworkComponents:e.components,components:{},headerComponents:{},disableDnd:e.disableDnd,headerframeworkComponents:e.headerComponents,frameworkWrapper:{header:{createComponent:t},body:{createComponent:t}}}),r=new Q(n),{clientWidth:a,clientHeight:h}=i.current;return n.layout(a,h),e.onReady&&e.onReady({api:r}),s.current=n,()=>{n.dispose()}}),[]),Re.useEffect((()=>{s.current&&s.current.updateOptions({frameworkComponents:e.components})}),[e.components]),Re.useEffect((()=>{s.current&&s.current.updateOptions({headerframeworkComponents:e.headerComponents})}),[e.headerComponents]),Re.useEffect((()=>{if(!s.current)return()=>{};const t=s.current,i=t.onDidDrop((i=>{e.onDidDrop&&e.onDidDrop(Object.assign(Object.assign({},i),{api:new Q(t)}))}));return()=>{i.dispose()}}),[e.onDidDrop]),Re.createElement("div",{className:e.className,style:{height:"100%",width:"100%"},ref:i},n)}));tt.displayName="PaneviewComponent"}}]);